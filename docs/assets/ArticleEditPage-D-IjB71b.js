import{_ as S,A as C,a as b,C as h,r as o,c as k,d as B,o as R,u as T,w as L,b as M,e as P,g as n,h as r,l as U,i as j,j as D,k as E}from"./index-B6iVMvAs.js";import{A as H,a as N,b as q,c as z}from"./ArticleTitleInput-DKynsF7E.js";const F={class:"panel-main edit-section"},G=["innerHTML"],J={__name:"ArticleEditPage",setup(K){const d=new C,A=new b(d),w=new h(d),p=new U(A,w),v=T(),m=j(),l=o(null),i=o(null),g=o(null),t=o({title:"",text:"",preview:"",tagsString:""}),u=k({get(){return t.value.text},set(e){t.value.text=e,t.value.preview=e==null?"":B.parse(e)}}),y=async()=>{g.value=!0,l.value=null;const e=await p.get({articleId:i.value});e.length>0&&(l.value=e[0],t.value.title=l.value.title,u.value=l.value.text,t.value.tagsString=l.value.tags?.join(" ")??""),g.value=!1},_=async function(){const{id:e,categoryId:a}=l.value,{title:c,text:s,tagsString:x}=t.value,V=Array.from(new Set(x.split(" ").filter(I=>I.length>0)).values());await p.set({id:e,categoryId:a,title:c,text:s,tags:V}),m.push({name:"ArticleReadPage",parems:{id:e}})},f=()=>{const{categoryId:e}=l.value;m.push({name:"ArticlesListPage",params:{categoryId:e}})};return R(()=>{i.value=parseInt(v.params.id),y()}),L(()=>v.params.categoryId,async e=>{i.value=parseInt(e),y()}),(e,a)=>{const c=D("TheMainLayout");return E(),M(c,null,{"panel-main":P(()=>[n("section",F,[n("header",null,[r(H,{modelValue:t.value.title,"onUpdate:modelValue":a[0]||(a[0]=s=>t.value.title=s)},null,8,["modelValue"])]),n("main",null,[r(N,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=s=>u.value=s)},null,8,["modelValue"]),n("div",{innerHTML:t.value.preview,class:"preview"},null,8,G)]),n("footer",null,[r(q,{modelValue:t.value.tagsString,"onUpdate:modelValue":a[2]||(a[2]=s=>t.value.tagsString=s)},null,8,["modelValue"]),r(z,{onClick:_}),n("button",{onClick:f,class:"button-cancel"}," キャンセル ")])])]),_:1})}}},W=S(J,[["__scopeId","data-v-d800a39b"]]);export{W as default};
