import{_ as S,A as C,a as h,C as k,r as o,c as B,d as R,o as T,u as b,w as L,b as M,e as P,g as n,h as r,l as U,i as j,j as D,k as E}from"./index-BGUAd7T9.js";import{A as H,a as N,b as q,c as z}from"./ArticleTitleInput-Dg_CtZnJ.js";const F={class:"panel-main edit-section"},G=["innerHTML"],J={__name:"ArticleEditPage",setup(K){const d=new C,A=new h(d),w=new k(d),p=new U(A,w),v=b(),m=j(),s=o(null),i=o(null),g=o(null),t=o({title:"",text:"",preview:"",tagsString:""}),u=B({get(){return t.value.text},set(e){t.value.text=e,t.value.preview=e==null?"":R.parse(e)}}),y=async()=>{g.value=!0,s.value=null;const e=await p.get({articleId:i.value});e.length>0&&(s.value=e[0],t.value.title=s.value.title,u.value=s.value.text,t.value.tagsString=s.value.tags?.join(" ")??""),g.value=!1},_=async function(){const{id:e,categoryId:a}=s.value,{title:c,text:l,tagsString:x}=t.value,V=Array.from(new Set(x.split(" ").filter(I=>I.length>0)).values());await p.set({id:e,categoryId:a,title:c,text:l,tags:V}),m.push({name:"ArticleReadPage",parems:{id:e}})},f=()=>{m.push({name:"ArticlesListPage"})};return T(()=>{i.value=parseInt(v.params.id),y()}),L(()=>v.params.categoryId,async e=>{i.value=parseInt(e),y()}),(e,a)=>{const c=D("TheMainLayout");return E(),M(c,null,{"panel-main":P(()=>[n("section",F,[n("header",null,[r(H,{modelValue:t.value.title,"onUpdate:modelValue":a[0]||(a[0]=l=>t.value.title=l)},null,8,["modelValue"])]),n("main",null,[r(N,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=l=>u.value=l)},null,8,["modelValue"]),n("div",{innerHTML:t.value.preview,class:"preview"},null,8,G)]),n("footer",null,[r(q,{modelValue:t.value.tagsString,"onUpdate:modelValue":a[2]||(a[2]=l=>t.value.tagsString=l)},null,8,["modelValue"]),r(z,{onClick:_}),n("button",{onClick:f,class:"button-cancel"}," キャンセル ")])])]),_:1})}}},W=S(J,[["__scopeId","data-v-0a32dd2e"]]);export{W as default};
