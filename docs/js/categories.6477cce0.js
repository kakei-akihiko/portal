"use strict";(self["webpackChunkportal"]=self["webpackChunkportal"]||[]).push([[267],{5825:function(e,l,a){a.r(l),a.d(l,{default:function(){return h}});var t=a(1033),s=a(2415);a(1166);class n{async parse(e){try{const l=await this.readFileAsText(e),a=JSON.parse(l).articles;return{succeeded:!0,articles:a}}catch(l){const e="ファイルの読み込みに失敗しました。";return console.log(e,l),{succeeded:!1,exception:l,message:e}}}async readFileAsText(e){return await new Promise((l=>{const a=new FileReader;a.onload=()=>l(a.result),a.readAsText(e)}))}}var o=a(7370),i=a(4793),c=a(5191),u=a(4559);const r={class:"h-100"},d={key:1,class:"h-100"},p={class:"form-group"},m={class:"custom-file b-form-file"},g={class:"d-flex"},v={class:"form-group ml-auto"},_=["disabled"],w={class:"list-group"},y={key:0,class:"badge bdge-info ml-auto"};var b={__name:"CategoryImportPage",setup(e){const l=new c.Z,a=new u.Z(l),b=new n,f=new o.Z(l),h=new i.Z(f,a),S=(0,s.yj)(),k=(0,t.iH)([]),U=(0,t.iH)(null),C=(0,t.iH)(null),P=(0,t.iH)(null),x=(0,t.Fl)((()=>{const e=k.value?.length??0,l=k.value?.filter((e=>!e.completed)).length??0,a=l<=0||null==P.value,t=e>0&&null!=P.value;return{disabled:a,visible:t}})),Z=async()=>{U.value=await a.get(C.value)},I=async e=>{if(console.log(e.target.files[0]),P.value=e.target.files[0],null==P.value)return;const l=await b.parse(P.value);l.succeeded&&(k.value=l.articles.map((e=>({...e,completed:!1}))))},F=()=>{k.value.filter((e=>!e.computed)).forEach((async e=>{const{title:l,text:a,tags:t}=e;await h.set({categoryId:C.value,title:l,text:a,tags:t}),e.completed=!0}))};return(0,t.bv)((()=>{C.value=parseInt(S.params.id),Z()})),(0,t.YP)((()=>S.params.id),(async e=>{C.value=parseInt(e),loadArticle()})),(e,l)=>{const a=(0,t.up)("TheSidebar"),s=(0,t.up)("NotFoundAlert"),n=(0,t.up)("TheMainLayout");return(0,t.wg)(),(0,t.j4)(n,{"main-panel-scroll":""},{sidebar:(0,t.w5)((()=>[(0,t.Wm)(a)])),"panel-main":(0,t.w5)((()=>[(0,t._)("div",r,[null==U.value?((0,t.wg)(),(0,t.j4)(s,{key:0})):((0,t.wg)(),(0,t.iD)("div",d,[(0,t._)("h2",null,"記事を"+(0,t.zw)(U.value.title)+"にインポート",1),(0,t._)("fieldset",p,[(0,t._)("div",m,[(0,t._)("input",{type:"file",accept:"application/json",onChange:I},null,32)])]),(0,t._)("div",g,[(0,t._)("fieldset",v,[(0,t.wy)((0,t._)("button",{disabled:(0,t.SU)(x).disabled,class:"btn btn-primary",onClick:F}," 選択をインポート ",8,_),[[t.F8,(0,t.SU)(x).visible]])])]),(0,t._)("div",w,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(k.value,(e=>((0,t.wg)(),(0,t.iD)("div",{class:"list-group-item d-flex",key:e.id},[(0,t._)("div",null,(0,t.zw)(e.title),1),e.completed?((0,t.wg)(),(0,t.iD)("span",y," 済 ")):(0,t.kq)("",!0)])))),128))])]))])])),_:1})}}};const f=b;var h=f},8994:function(e,l,a){a.r(l),a.d(l,{default:function(){return C}});var t=a(1033),s=a(9446),n=a(5191),o=a(4559);const i={class:"h-100"},c=(0,t._)("h2",null,"カテゴリー",-1),u={class:"section-new-card"},r=(0,t._)("h3",null,"新規作成",-1),d={class:"card card-new-category"},p={class:"card-body"},m={class:"form-group",label:"名称"},g=(0,t._)("legend",{tabindex:"-1",class:"col-form-label pt-0"}," 名称 ",-1),v={class:"form-group mb-0"},_=["disabled"],w={class:"section-list"},y=(0,t._)("h3",null,"一覧",-1),b={class:"card-body d-flex"},f={class:"ml-auto h-interval"},h=["onClick"],S=(0,t._)("i",{class:"fas fa-download"},null,-1);var k={__name:"CategoryPage",setup(e){const l=new n.Z,a=new o.Z(l),k=(0,t.iH)({created:!1,name:""}),U=(0,t.Fl)((()=>{const{created:e,name:l}=k.value;return e||null==l||l.length<=0})),C=(0,t.Fl)({get(){return k.value.name},set(e){k.value.name=e,k.value.created=!1}});(0,t.bv)((async()=>{s.Z.dispatch("loadCategories")}));const P=async()=>{k.value.created=!0;const e=k.value.name,l="single";await a.put({title:e,tagSelectionMode:l}),s.Z.dispatch("loadCategories"),k.value.name=""},x=async e=>{const l=e.id;s.Z.dispatch("exportArticles",{categoryId:l})};return(e,l)=>{const a=(0,t.up)("TheSidebar"),n=(0,t.up)("router-link"),o=(0,t.up)("TheMainLayout");return(0,t.wg)(),(0,t.j4)(o,{"main-panel-scroll":""},{sidebar:(0,t.w5)((()=>[(0,t.Wm)(a)])),"panel-main":(0,t.w5)((()=>[(0,t._)("div",i,[c,(0,t._)("section",u,[r,(0,t._)("div",d,[(0,t._)("div",p,[(0,t._)("fieldset",m,[g,(0,t.wy)((0,t._)("input",{class:"form-control",type:"text","onUpdate:modelValue":l[0]||(l[0]=e=>(0,t.dq)(C)?C.value=e:null)},null,512),[[t.nr,(0,t.SU)(C)]])]),(0,t._)("fieldset",v,[(0,t._)("button",{disabled:(0,t.SU)(U),class:"btn btn-primary",onClick:P}," 作成 ",8,_)])])])]),(0,t._)("section",w,[y,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,t.SU)(s.Z).state.categories,(e=>((0,t.wg)(),(0,t.iD)("div",{class:"card",key:e.id},[(0,t._)("div",b,[(0,t._)("div",null,(0,t.zw)(e.title),1),(0,t._)("div",f,[(0,t.Wm)(n,{to:{name:"CategoryImportPage",params:{id:e.id}}},{default:(0,t.w5)((()=>[(0,t.Uk)(" インポート ")]),void 0,!0),_:2},1032,["to"]),(0,t._)("button",{class:"btn btn-info",onClick:l=>x(e)},[S,(0,t.Uk)(" エクスポート ")],8,h)])])])))),128))])])])),_:1})}}};const U=k;var C=U},4265:function(e,l,a){a.r(l),a.d(l,{default:function(){return Z}});var t=a(1033),s=a(2415),n=a(5191),o=a(4559),i=a(9446);const c={slot:"panel-main",class:"h-100"},u={key:1,class:"h-100"},r={class:"form-group"},d={class:"form-row"},p=(0,t._)("legend",{tabindex:"-1",class:"col-4 col-form-label pt-0"}," タグの選択 ",-1),m={class:"col"},g={class:"custom-control custom-control-inline custom-radio"},v=(0,t._)("label",{class:"custom-control-label",for:"tagsSelection-single"},[(0,t._)("span",null,"最大1個")],-1),_={class:"custom-control custom-control-inline custom-radio"},w=(0,t._)("label",{class:"custom-control-label",for:"tagsSelection-multiple"},[(0,t._)("span",null,"複数")],-1),y={class:"form-group"},b={class:"form-row"},f=(0,t._)("legend",{tabindex:"-1",class:"col-4 col-form-label pt-0"}," タグの表示位置 ",-1),h={class:"col"},S={class:"custom-control custom-control-inline custom-radio"},k=(0,t._)("label",{class:"custom-control-label",for:"tagsPosition-right"},[(0,t._)("span",null,"タイトルの右")],-1),U={class:"custom-control custom-control-inline custom-radio"},C=(0,t._)("label",{class:"custom-control-label",for:"tagsPosition-bottom"},[(0,t._)("span",null,"タイトルの下")],-1);var P={__name:"CategorySettingPage",setup(e){const l=new n.Z,a=new o.Z(l),P=(0,t.iH)(null),x=(0,t.iH)(null),Z=(0,s.yj)(),I=async()=>{P.value=await a.get(x.value)},F=(0,t.Fl)({get(){return P.value?.tagPosition??"right"},async set(e){await i.Z.dispatch("setCategorySettings",{categoryId:x.value,tagPosition:e}),await I()}}),H=(0,t.Fl)({get(){return P.value?.tagSelectionMode??"single"},async set(e){console.log("tagSelectionSelected set",e),await i.Z.dispatch("setCategorySettings",{categoryId:x.value,tagSelectionMode:e}),await I()}});return(0,t.YP)((()=>Z.params.categoryId),(async e=>{x.value=parseInt(e),I()})),(0,t.bv)((()=>{x.value=parseInt(Z.params.categoryId),I()})),(e,l)=>{const a=(0,t.up)("TheSidebar"),s=(0,t.up)("NotFoundAlert"),n=(0,t.up)("TheMainLayout");return(0,t.wg)(),(0,t.j4)(n,{"main-panel-scroll":""},{sidebar:(0,t.w5)((()=>[(0,t.Wm)(a)])),"panel-main":(0,t.w5)((()=>[(0,t._)("div",c,[null==P.value?((0,t.wg)(),(0,t.j4)(s,{key:0})):((0,t.wg)(),(0,t.iD)("div",u,[(0,t._)("h2",null,(0,t.zw)(P.value.title)+"の設定",1),(0,t._)("form",null,[(0,t._)("fieldset",r,[(0,t._)("div",d,[p,(0,t._)("div",m,[(0,t._)("div",g,[(0,t.wy)((0,t._)("input",{class:"custom-control-input",type:"radio",name:"tagsSelection",value:"single","onUpdate:modelValue":l[0]||(l[0]=e=>(0,t.dq)(H)?H.value=e:null),id:"tagsSelection-single"},null,512),[[t.G2,(0,t.SU)(H)]]),v]),(0,t._)("div",_,[(0,t.wy)((0,t._)("input",{class:"custom-control-input",type:"radio",name:"tagsSelection",value:"multiple","onUpdate:modelValue":l[1]||(l[1]=e=>(0,t.dq)(H)?H.value=e:null),id:"tagsSelection-multiple"},null,512),[[t.G2,(0,t.SU)(H)]]),w])])])]),(0,t._)("fieldset",y,[(0,t._)("div",b,[f,(0,t._)("div",h,[(0,t._)("div",S,[(0,t.wy)((0,t._)("input",{class:"custom-control-input",type:"radio",name:"tagsPosition",value:"right","onUpdate:modelValue":l[2]||(l[2]=e=>(0,t.dq)(F)?F.value=e:null),id:"tagsPosition-right"},null,512),[[t.G2,(0,t.SU)(F)]]),k]),(0,t._)("div",U,[(0,t.wy)((0,t._)("input",{class:"custom-control-input",type:"radio",name:"tagsPosition",value:"bottom","onUpdate:modelValue":l[3]||(l[3]=e=>(0,t.dq)(F)?F.value=e:null),id:"tagsPosition-bottom"},null,512),[[t.G2,(0,t.SU)(F)]]),C])])])])])]))])])),_:1})}}};const x=P;var Z=x}}]);
//# sourceMappingURL=categories.6477cce0.js.map