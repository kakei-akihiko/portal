(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["categories"],{4875:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("TheMainLayout",{attrs:{"main-panel-scroll":""}},[e("TheSidebar",{attrs:{slot:"sidebar"},slot:"sidebar"}),e("div",{staticClass:"h-100",attrs:{slot:"panel-main"},slot:"panel-main"},[null==t.category?e("NotFoundAlert"):e("div",{staticClass:"h-100"},[e("h2",[t._v("記事を"+t._s(t.category.title)+"にインポート")]),e("b-form-group",[e("b-form-file",{attrs:{value:t.file,accept:"application/json",placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here..."},on:{input:t.fileSelect},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),e("div",{staticClass:"d-flex"},[e("b-form-group",{staticClass:"ml-auto"},[e("b-button",{directives:[{name:"show",rawName:"v-show",value:t.importButton.visible,expression:"importButton.visible"}],attrs:{disabled:t.importButton.disabled,variant:"primary"},on:{click:t.importButtonClick}},[t._v(" 選択をインポート ")])],1)],1),e("b-list-group",t._l(t.articles,(function(a){return e("b-list-group-item",{key:a.id,staticClass:"d-flex"},[e("div",[t._v(t._s(a.title))]),a.completed?e("b-badge",{staticClass:"ml-auto",attrs:{variant:"info"}},[t._v(" 済 ")]):t._e()],1)})),1)],1)],1)],1)},s=[];class r{async parse(t){try{const e=await this.readFileAsText(t),a=JSON.parse(e).articles;return{succeeded:!0,articles:a}}catch(e){const t="ファイルの読み込みに失敗しました。";return console.log(t,e),{succeeded:!1,exception:e,message:t}}}async readFileAsText(t){return await new Promise(e=>{const a=new FileReader;a.onload=()=>e(a.result),a.readAsText(t)})}}var i=a("6bfa"),l=a("2bcf"),n=a("ff8a"),c=a("26b9");const d=new n["a"],u=new c["a"](d),g=new r,p=new i["a"](d),h=new l["a"](p,u);var y={name:"CategoryImportPage",data(){return{articles:[],category:null,categoryId:null,file:null}},computed:{importButton(){const t=null==this.articles?0:this.articles.length,e=null==this.articles?0:this.articles.filter(t=>!t.completed).length,a=e<=0||null==this.file,o=t>0&&null!=this.file;return{disabled:a,visible:o}}},watch:{$route(t){this.categoryId=parseInt(t.params.id),this.loadCategory()}},mounted(){this.categoryId=parseInt(this.$route.params.id),this.loadCategory()},methods:{async fileSelect(t){this.file=t;const{succeeded:e,articles:a}=await g.parse(t);e&&(this.articles=a.map(t=>({...t,completed:!1})))},async importButtonClick(){this.articles.filter(t=>!t.computed).forEach(async t=>{const{title:e,text:a,tags:o}=t,s=this.categoryId;await h.set({categoryId:s,title:e,text:a,tags:o}),t.completed=!0})},async loadCategory(){this.category=await u.get(this.categoryId)}}},m=y,b=a("2877"),v=Object(b["a"])(m,o,s,!1,null,null,null);e["default"]=v.exports},"622d":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("TheMainLayout",{attrs:{"main-panel-scroll":""}},[e("TheSidebar",{attrs:{slot:"sidebar"},slot:"sidebar"}),e("div",{staticClass:"h-100",attrs:{slot:"panel-main"},slot:"panel-main"},[e("h2",[t._v("カテゴリー")]),e("section",{staticClass:"section-new-card"},[e("h3",[t._v("新規作成")]),e("b-card",{staticClass:"card-new-category"},[e("b-form-group",{attrs:{label:"名称"}},[e("b-input",{model:{value:t.cardNewCategoryName,callback:function(e){t.cardNewCategoryName=e},expression:"cardNewCategoryName"}})],1),e("b-form-group",{staticClass:"mb-0",attrs:{"label-sr-only":""}},[e("b-button",{attrs:{disabled:t.cardNewCategoryCreateButtonDisabled,variant:"primary"},on:{click:t.createCategoryButtonClick}},[t._v(" 作成 ")])],1)],1)],1),e("section",{staticClass:"section-list"},[e("h3",[t._v("一覧")]),t._l(t.$store.state.categories,(function(a){return e("b-card",{key:a.id,attrs:{"body-class":"d-flex"}},[e("div",[t._v(" "+t._s(a.title)+" ")]),e("div",{staticClass:"ml-auto h-interval"},[e("router-link",{attrs:{to:{name:"CategoryImportPage",params:{id:a.id}}}},[t._v(" インポート ")]),e("b-button",{attrs:{variant:"info"},on:{click:function(e){return t.exportButtonClick(a)}}},[e("i",{staticClass:"fas fa-download"}),t._v(" エクスポート ")])],1)])}))],2)])],1)},s=[],r=a("ff8a"),i=a("26b9");const l=new r["a"],n=new i["a"](l);var c={name:"CategoryPage",computed:{cardNewCategoryCreateButtonDisabled(){const{created:t,name:e}=this.cardNewCategory;return t||null==e||e.length<=0},cardNewCategoryName:{get(){return this.cardNewCategory.name},set(t){this.cardNewCategory.name=t,this.cardNewCategory.created=!1}}},data(){return{cardNewCategory:{created:!1,name:""}}},mounted(){this.$store.dispatch("loadCategories")},methods:{async createCategoryButtonClick(){this.cardNewCategory.created=!0;const t=this.cardNewCategory.name,e="single",a=await n.put({title:t,tagSelectionMode:e});console.log("Category created. categoryId:",a),this.$store.dispatch("loadCategories")},async exportButtonClick(t){const e=t.id;this.$store.dispatch("exportArticles",{categoryId:e})}}},d=c,u=a("2877"),g=Object(u["a"])(d,o,s,!1,null,null,null);e["default"]=g.exports},"8be7":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("TheMainLayout",{attrs:{"main-panel-scroll":""}},[e("TheSidebar",{attrs:{slot:"sidebar"},slot:"sidebar"}),e("div",{staticClass:"h-100",attrs:{slot:"panel-main"},slot:"panel-main"},[null==t.category?e("NotFoundAlert"):e("div",{staticClass:"h-100"},[e("h2",[t._v(t._s(t.category.title)+"の設定")]),e("b-form",[e("b-form-group",{attrs:{label:"タグの選択","label-cols":"4"}},[e("b-radio-group",{attrs:{name:"tagsSelection",options:t.tagSelection.options},model:{value:t.tagSelectionSelected,callback:function(e){t.tagSelectionSelected=e},expression:"tagSelectionSelected"}})],1),e("b-form-group",{attrs:{label:"タグの表示位置","label-cols":"4"}},[e("b-radio-group",{attrs:{name:"tagsPosition",options:t.tagsPosition.options},model:{value:t.tagPositionSelected,callback:function(e){t.tagPositionSelected=e},expression:"tagPositionSelected"}})],1)],1)],1)],1)],1)},s=[],r=a("ff8a"),i=a("26b9");const l=new r["a"],n=new i["a"](l);var c={name:"CategorySettingPage",data(){return{category:null,categoryId:null,tagsPosition:{options:[{text:"タイトルの右",value:"right"},{text:"タイトルの下",value:"bottom"}]},tagSelection:{options:[{text:"最大1個",value:"single"},{text:"複数",value:"multiple"}]}}},computed:{tagPositionSelected:{get(){var t,e;return null!==(t=null===(e=this.category)||void 0===e?void 0:e.tagPosition)&&void 0!==t?t:"right"},async set(t){const{categoryId:e}=this;await this.$store.dispatch("setCategorySettings",{categoryId:e,tagPosition:t}),await this.loadCategory()}},tagSelectionSelected:{get(){var t,e;return null!==(t=null===(e=this.category)||void 0===e?void 0:e.tagSelectionMode)&&void 0!==t?t:"single"},async set(t){const{categoryId:e}=this;await this.$store.dispatch("setCategorySettings",{categoryId:e,tagSelectionMode:t}),await this.loadCategory()}}},watch:{$route(t){this.categoryId=parseInt(t.params.categoryId),this.loadCategory()}},mounted(){this.categoryId=parseInt(this.$route.params.categoryId),this.loadCategory()},methods:{async loadCategory(){this.category=await n.get(this.categoryId)}}},d=c,u=a("2877"),g=Object(u["a"])(d,o,s,!1,null,null,null);e["default"]=g.exports}}]);
//# sourceMappingURL=categories.4177a8b6.js.map