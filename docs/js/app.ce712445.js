(function(){"use strict";var t={7370:function(t,e,a){a.d(e,{Z:function(){return o}});var n=a(8090),r=a.n(n),i=a(4769),s=a.n(i);r().extend(s());class o{constructor(t){this.database=t.instance}async addTagsToArticle(t,e){const a=e.map((e=>({articleId:t,tagText:e})));await this.database.articleTags.bulkPut(a)}async deleteTagsFromArticle(t){await this.database.articleTags.bulkDelete(t)}export(t){const e=JSON.stringify({articles:t},null,2),a=new Blob([e],{type:"application/json"}),n=document.createElement("a");n.href=URL.createObjectURL(a),n.target="_blank",n.download="Articles.json",document.body.appendChild(n),n.click(),document.body.removeChild(n)}async getArticles({categoryId:t,articleId:e}){return await this.database.articles.filter((a=>(null==t||a.categoryId===t)&&(null==e||a.id===e))).toArray()}async getArticleTags(t){return await this.database.articleTags.filter((e=>t.includes(e.articleId))).toArray()}async getTagTexts(t){return await this.database.articleTags.filter((e=>e.articleId===t)).toArray()}async setArticle({id:t,categoryId:e,expanded:a,title:n,text:i}){const s=r().utc().format();return await this.database.articles.put({id:t,categoryId:e,expanded:a,title:n,text:i,updatedOn:s})}}},5191:function(t,e,a){a.d(e,{Z:function(){return r}});var n=a(2420);class r{constructor(){this.instance=new n.ZP("articlesDatabase"),this.instance.version(2).stores({articles:"++id, categoryId, title, text, createdOn, updatedOn",articleTags:"++id, articleId, tagText",categories:"++id, title",settings:"name"}),this.instance.version(1).stores({articles:"++id, categoryId, title, text, createdOn, updatedOn",articleTags:"++id, articleId, tagText",categories:"++id, title"})}delete(){n.ZP["delete"]("articlesDatabase")}}},4559:function(t,e,a){a.d(e,{Z:function(){return n}});class n{constructor(t){this.database=t.instance}async get(t){return await this.database.categories.get(t)}async getAll(){return this.database.categories.toArray()}async put({categoryId:t,title:e,icon:a,articlesViewMode:n,tagPosition:r,tagSelectionMode:i}){try{const s=await this.database.categories.put({id:t,title:e,icon:a,articlesViewMode:n,tagPosition:r,tagSelectionMode:i});return console.log("Inserted. categoryId:",s),s}catch(s){console.error(s.stack||s)}}}},9866:function(t,e,a){a.d(e,{T:function(){return n.TU}});var n=a(9747);const r=new n.TU.Renderer,i=r.link;r.link=(t,e,a)=>{const n=t.startsWith(`${location.protocol}//${location.hostname}`),s=i.call(r,t,e,a);return n?s:s.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')},n.TU.setOptions({renderer:r})},767:function(t,e,a){var n=a(1033);const r={id:"app"};function i(t,e){const a=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(a)])}var s=a(3615);const o={},c=(0,s.Z)(o,[["render",i]]);var l=c,d=a(1166),u=a(9446),g=a(9204);const p={class:"d-flex flex-column h-100"},f={class:"flex-grow-1 h-0"},m={class:"h-100"};function y(t,e){return(0,n.wg)(),(0,n.iD)("div",p,[(0,n.WI)(t.$slots,"header",{},void 0,!0),(0,n._)("div",f,[(0,n._)("div",m,[(0,n.WI)(t.$slots,"default",{},void 0,!0)])]),(0,n.WI)(t.$slots,"footer",{},void 0,!0)])}const h={},v=(0,s.Z)(h,[["render",y],["__scopeId","data-v-184826a2"]]);var w=v;const b={class:"container-fluid h-100 container-main"},k={class:"row h-100"},S={key:0,class:"col-sm-4 col-md-3 col-12 h-100-sm sidebar pr-0"},_={class:"h-100 pr-3"};var x={__name:"TheMainLayout",props:{noSidebar:Boolean,mainPanelScroll:Boolean},setup(t){const e=t,a=(0,n.Fl)((()=>({"col-sm-8":!e.noSidebar,"col-sm-12":e.noSidebar,"col-md-9":!e.noSidebar,"col-md-12":e.noSidebar,"h-100-sm":!0,"panel-main":!0,"overflow-auto":e.mainPanelScroll})));return(e,r)=>((0,n.wg)(),(0,n.iD)("div",b,[(0,n._)("div",k,[t.noSidebar?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",S,[(0,n._)("div",_,[(0,n.WI)(e.$slots,"sidebar")])])),(0,n._)("div",{cols:"12",class:(0,n.C_)((0,n.SU)(a))},[(0,n.WI)(e.$slots,"panel-main")],2)])]))}};const I=x;var T=I;a(825);const A=t=>((0,n.dD)("data-v-06c23644"),t=t(),(0,n.Cn)(),t),C={class:"d-flex flex-column h-100"},P=A((()=>(0,n._)("h1",{class:"h2"},[(0,n._)("span",null,"🏠"),(0,n._)("span",{class:"site-title-animals"},"🐕🦘🐬🐓🕊🦢")],-1))),D=A((()=>(0,n._)("div",{class:"mt-auto"},null,-1))),Z={key:0},M=["innerHTML"],E={key:1,class:"form-group"},F=A((()=>(0,n._)("i",{class:"far fa-newspaper"},null,-1))),U=A((()=>(0,n._)("span",{class:"ml-2"},"記事",-1))),O=[F,U],R={key:2,class:"form-group"},j=A((()=>(0,n._)("i",{class:"far fa-folder-open"},null,-1))),q=A((()=>(0,n._)("span",{class:"ml-2"},"カテゴリー",-1))),L=[j,q],N={key:3,class:"form-group"},V=A((()=>(0,n._)("i",{class:"fas fa-cog"},null,-1))),W=A((()=>(0,n._)("span",{class:"ml-2"},"設定",-1))),H=[V,W];var B={__name:"TheSidebar",setup(t){const e=(0,n.Fl)((()=>u.Z.state.sidebar.article));(0,n.bv)((async()=>{null==u.Z.state.sidebar.articleId&&await u.Z.dispatch("sidebar/loadSetting")}));const a=()=>{d.Z.push({name:"ArticlesListPage"})},r=()=>{d.Z.push({name:"CategoryPage"})},i=()=>{d.Z.push({name:"SettingPage"})};return(t,s)=>((0,n.wg)(),(0,n.iD)("div",C,[P,(0,n.WI)(t.$slots,"default"),D,null!=(0,n.SU)(e)?((0,n.wg)(),(0,n.iD)("div",Z,[(0,n._)("div",{innerHTML:(0,n.SU)(e).html},null,8,M)])):(0,n.kq)("",!0),"ArticlesListPage"!=t.$route.name?((0,n.wg)(),(0,n.iD)("fieldset",E,[(0,n._)("button",{class:"btn btn-link",onClick:a},O)])):(0,n.kq)("",!0),"CategoryPage"!=t.$route.name?((0,n.wg)(),(0,n.iD)("fieldset",R,[(0,n._)("button",{class:"btn btn-link",onClick:r},L)])):(0,n.kq)("",!0),"SettingPage"!=t.$route.name?((0,n.wg)(),(0,n.iD)("fieldset",N,[(0,n._)("button",{class:"btn btn-link",onClick:i},H)])):(0,n.kq)("",!0)]))}};const $=(0,s.Z)(B,[["__scopeId","data-v-06c23644"]]);var z=$;class K{constructor(t){this.database=t.instance}async get(t){return await this.database.settings.get(t)}async put(t){try{return await this.database.settings.put(t)}catch(e){console.error(e.stack??e)}}}class Y{constructor(t){this.settingRepository=t}async getSidebarSetting(){const{articleId:t}=await this.settingRepository.get("sidebar")??{};return{name:"sidebar",articleId:t}}async setSidebarArticleId(t){const e=await this.getSidebarSetting();e.articleId=t,console.log("service sidebar:",e),await this.settingRepository.put(e)}}n.ZP.component("NotFoundAlert",g.Z),n.ZP.component("FullHeight",w),n.ZP.component("TheMainLayout",T),n.ZP.component("TheSidebar",z),n.ZP.config.productionTip=!1;const G=new K(u.m.articlesDatabase),J=new Y(G);u.m.settingService=J,n.ZP.createApp({render:t=>t(l)}).use(d.Z).use(u.Z).mount("#app")},1166:function(t,e,a){a.d(e,{Z:function(){return At}});var n=a(2415),r=a(1033),i=a(9446),s=(a(825),a(9866));const o={key:0,class:"fas fa-arrow-circle-down"},c={key:1,class:"fas fa-arrow-circle-up"};var l={__name:"ButtonExpand",props:{expanded:Boolean},emits:["click"],setup(t,{emit:e}){const a=t,n=()=>{e("click")};return(t,e)=>((0,r.wg)(),(0,r.iD)("button",{class:"btn btn-link p-0",onClick:n},[a.expanded?((0,r.wg)(),(0,r.iD)("i",o)):((0,r.wg)(),(0,r.iD)("i",c))]))}};const d=l;var u=d;const g={class:"card","body-class":"py-2"},p={class:"card-body py-2"},f={class:"d-flex align-items-center"},m={class:"mr-auto d-flex flex-column"},y={class:"title"},h={key:0},v=["href"],w={key:0,class:"tags"},b={key:0,class:"tags pr-2 h-interval"},k={class:"right-side"},S={key:0,class:"pr-2 d-inline-block h-interval"},_=(0,r._)("i",{class:"far fa-newspaper"},null,-1),x=[_],I=(0,r._)("i",{class:"fas fa-edit"},null,-1),T=[I],A=["innerHTML"];var C={__name:"ArticlePanel",props:{article:{type:Object,required:!0},tagPosition:{default:"right",type:String}},emits:["expand"],setup(t,{emit:e}){const a=t,i=((0,n.yj)(),(0,r.Fl)((()=>s.T.parse(a.article.text)))),o=(0,r.Fl)((()=>null!=a.article.text&&a.article.text.length>0)),c=(0,r.Fl)((()=>!0===a.article.expanded)),l=(0,r.Fl)((()=>"bottom"===a.tagPosition)),d=()=>{At.push({name:"ArticleEditPage",params:{id:a.article.id}})},_=()=>{At.push({name:"ArticleReadPage",params:{id:a.article.id}})},I=()=>{e("expand",!c.value)};return(e,a)=>((0,r.wg)(),(0,r.iD)("div",g,[(0,r._)("div",p,[(0,r._)("div",f,[(0,r._)("div",m,[(0,r._)("div",y,[null==t.article.url?((0,r.wg)(),(0,r.iD)("span",h,(0,r.zw)(t.article.title),1)):((0,r.wg)(),(0,r.iD)("a",{key:1,href:t.article.url,target:"_blank"},(0,r.zw)(t.article.title),9,v))]),(0,r.SU)(l)?((0,r.wg)(),(0,r.iD)("div",w,[null!=t.article.tags?((0,r.wg)(),(0,r.iD)("div",b,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.article.tags,(t=>((0,r.wg)(),(0,r.iD)("span",{key:t,class:"badge badge-info"},(0,r.zw)(t),1)))),128))])):(0,r.kq)("",!0)])):(0,r.kq)("",!0)]),(0,r._)("div",k,[(0,r.SU)(l)||null==t.article.tags?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",S,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.article.tags,(t=>((0,r.wg)(),(0,r.iD)("span",{key:t,class:"badge badge-info"},(0,r.zw)(t),1)))),128))])),(0,r.SU)(o)?((0,r.wg)(),(0,r.j4)(u,{key:1,expanded:(0,r.SU)(c),onClick:I},null,8,["expanded"])):(0,r.kq)("",!0),(0,r._)("button",{class:"btn btn-link",onClick:_},x),(0,r._)("button",{class:"btn btn-link",onClick:d},T)])]),(0,r.wy)((0,r._)("div",{innerHTML:(0,r.SU)(i),class:"article-body-view"},null,8,A),[[r.F8,(0,r.SU)(c)]])])]))}};const P=C;var D=P;const Z=(0,r._)("i",{class:"fas fa-plus"},null,-1),M=[Z];var E={__name:"ButtonArticleCreatePage",props:{categoryId:Number},setup(t){const e=t,a=()=>{const{categoryId:t}=e;At.push({name:"ArticleCreatePage",params:{categoryId:t}})};return(t,e)=>((0,r.wg)(),(0,r.iD)("button",{class:"btn btn-link",onClick:a},M))}};const F=E;var U=F;const O=(0,r._)("i",{class:"fas fa-cog"},null,-1),R=[O];var j={__name:"ButtonCategorySettingPage",props:{categoryId:Number},setup(t){const e=t,a=()=>{const{categoryId:t}=e;At.push({name:"CategorySettingPage",params:{categoryId:t}})};return(t,e)=>((0,r.wg)(),(0,r.iD)("button",{class:"btn btn-link",onClick:a},R))}};const q=j;var L=q;const N=["href"];var V={__name:"CampactLinksPanel",props:{table:Array},setup(t){const e=t;return(t,a)=>((0,r.wg)(),(0,r.iD)("div",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.table,(t=>((0,r.wg)(),(0,r.iD)("div",{key:t.text,class:"h-interval"},[(0,r._)("h3",null,(0,r.zw)(t.text),1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.articles,(t=>((0,r.wg)(),(0,r.iD)("a",{key:t.id,href:t.url,target:"_blank"},(0,r.zw)(t.title),9,N)))),128))])))),128))]))}};const W=V;var H=W;const B={class:"nav nav-pills small"},$={class:"nav-item"},z={class:"nav-item"};var K={__name:"NavArticleViewMode",props:{mode:String},emits:["change"],setup(t,{emit:e}){const a=t,n=(0,r.Fl)((()=>({active:"compact"===a.mode,"nav-link":!0}))),i=(0,r.Fl)((()=>({active:"detail"===a.mode,"nav-link":!0}))),s=()=>{e("change","compact")},o=()=>{e("change","detail")};return(t,e)=>((0,r.wg)(),(0,r.iD)("ul",B,[(0,r._)("li",$,[(0,r._)("a",{class:(0,r.C_)((0,r.SU)(n)),href:"#",target:"_self",onClick:s}," コンパクト ",2)]),(0,r._)("li",z,[(0,r._)("a",{class:(0,r.C_)((0,r.SU)(i)),href:"#",target:"_self",onClick:o}," 詳細 ",2)])]))}};const Y=K;var G=Y;class J{create(t,e){const a=this.getArticles(t,e),n=this.getTags(a);return this.getTable(a,n)}getArticles(t,e){return t.filter((t=>null!=t.url)).filter((t=>this.isTargetArticle(t,e)))}isTargetArticle(t,e){return null==e||e.length<=0||null!=t.tags&&e.every((e=>t.tags.includes(e)))}getTags(t){const e=t.some((t=>null==t.tags||t.tags.length<=0)),a=e?[{text:"（タグなし）",value:null}]:[],n=t.map((t=>t.tags)).reduce(((t,e)=>(e.forEach((e=>{!1===t.includes(e)&&t.push(e)})),t)),[]).map((t=>({text:t,value:t})));return[...a,...n]}getTable(t,e){return e.map((e=>{const a=t.filter((t=>null==e.value?null==t.tags||t.tags.length<=0:null!=t.tags&&t.tags.includes(e.value)));return{...e,articles:a}}))}}const Q={class:"h-100"},X={class:"d-flex"},tt={class:"ml-auto"},et={class:"form-group"},at={class:"command-bar d-flex justify-content-end"},nt={class:"alerts pt-3"},rt={key:0,class:"alert alert-warning"},it={key:1,class:"alert alert-warning"},st={key:2,class:"alert alert-warning"},ot={key:0,class:"pt-3"};var ct={__name:"ArticleListPageMainPanel",props:{category:{type:Object,required:!0}},setup(t){const e=t,a=new J,n=(0,r.Fl)((()=>"detail"===e.category.articlesViewMode?"detail":"compact")),s=(0,r.Fl)((()=>"compact"===n.value)),o=(0,r.Fl)((()=>"detail"===n.value)),c=(0,r.Fl)((()=>{const{articles:t,selectedTagTexts:e}=i.Z.state;return t.filter((t=>a.isTargetArticle(t,e)))})),l=(0,r.Fl)((()=>{const{articles:t,selectedTagTexts:e}=i.Z.state;return a.create(t,e)})),d=(0,r.Fl)((()=>o.value&&c.value.length<=0&&l.value.length>0)),u=(0,r.Fl)((()=>s.value&&c.value.length>0&&l.value.length<=0)),g=(0,r.Fl)((()=>c.value.length<=0&&l.value.length<=0)),p=(t,e)=>{const{id:a}=t;i.Z.dispatch("setArticleExpanded",{id:a,expanded:e})},f=t=>{const a=e.category.id;i.Z.dispatch("setArticlesViewModeToCategory",{categoryId:a,articlesViewMode:t})};return(e,a)=>((0,r.wg)(),(0,r.iD)("div",Q,[(0,r._)("div",X,[(0,r._)("h2",null,(0,r.zw)(t.category.title),1),(0,r._)("div",tt,[(0,r._)("fieldset",et,[(0,r.Wm)(L,{"category-id":t.category.id},null,8,["category-id"]),(0,r.Wm)(U,{"category-id":t.category.id},null,8,["category-id"])])])]),(0,r._)("div",at,[(0,r.Wm)(G,{mode:(0,r.SU)(n),onChange:f},null,8,["mode"])]),(0,r._)("div",nt,[(0,r.SU)(d)?((0,r.wg)(),(0,r.iD)("div",rt," 詳細モードで可能な記事がありません。コンパクトモードであれば表示できます。 ")):(0,r.kq)("",!0),(0,r.SU)(u)?((0,r.wg)(),(0,r.iD)("div",it," コンパクトモードで可能な記事がありません。詳細モードであれば表示できます。 ")):(0,r.kq)("",!0),(0,r.SU)(g)?((0,r.wg)(),(0,r.iD)("div",st," 検索条件に合致する記事がありません。 ")):(0,r.kq)("",!0)]),(0,r.SU)(o)?((0,r.wg)(),(0,r.iD)("div",ot,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(c),(e=>((0,r.wg)(),(0,r.j4)(D,{key:e.id,article:e,tagPosition:t.category.tagPosition,onExpand:t=>p(e,t)},null,8,["article","tagPosition","onExpand"])))),128))])):(0,r.kq)("",!0),(0,r.SU)(s)?((0,r.wg)(),(0,r.j4)(H,{key:1,table:(0,r.SU)(l),class:"pt-3"},null,8,["table"])):(0,r.kq)("",!0)]))}};const lt=ct;var dt=lt;const ut={class:"nav flex-column nav-category mt-3"},gt=["onClick"];var pt={__name:"NavCategories",setup(t){const e=(0,r.Fl)((()=>i.Z.state.categories.map((t=>{const{id:e,title:a}=t,n=e===i.Z.state.categoryId,r={active:n,"nav-link":!0};return{anchorClass:r,id:e,title:a}})))),a=async t=>{null!=t&&(i.Z.commit("setCategoryId",t.id),await i.Z.dispatch("loadArticles",t.id))};return(t,n)=>((0,r.wg)(),(0,r.iD)("ul",ut,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(e),(t=>((0,r.wg)(),(0,r.iD)("li",{class:"nav-item",key:t.id,onClick:e=>a(t)},[(0,r._)("a",{class:(0,r.C_)(t.anchorClass),href:"#",target:"_self"},(0,r.zw)(t.title),3)],8,gt)))),128))]))}};const ft=pt;var mt=ft;const yt={class:"form-group"},ht=["onClick"];var vt={__name:"FormGroupTagButtons",setup(t){const e=(0,r.Fl)((()=>i.Z.getters.allTags)),a=(0,r.Fl)((()=>e.value.map((t=>{const{selected:e,text:a}=t,n=e?"btn btn-sm btn-info":"btn btn-sm btn-outline-info";return{selected:e,text:a,className:n}})))),n=t=>{const{text:e,selected:a}=t;i.Z.commit("selectTagText",{text:e,selected:!a})};return(t,e)=>((0,r.wg)(),(0,r.iD)("fieldset",yt,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(a),(t=>((0,r.wg)(),(0,r.iD)("button",{key:t.text,class:(0,r.C_)(t.className),onClick:e=>n(t)},(0,r.zw)(t.text),11,ht)))),128))]))}};const wt=vt;var bt=wt;const kt={class:"h-100"};var St={__name:"ArticlesListPage",setup(t){const e=(0,r.Fl)((()=>i.Z.state.categories.filter((t=>t.id===i.Z.state.categoryId))[0]));return(0,r.bv)((()=>{i.Z.dispatch("loadCategories")})),(t,a)=>{const n=(0,r.up)("TheSidebar"),i=(0,r.up)("TheMainLayout");return(0,r.wg)(),(0,r.j4)(i,{"main-panel-scroll":""},{sidebar:(0,r.w5)((()=>[(0,r.Wm)(n,null,{default:(0,r.w5)((()=>[(0,r.Wm)(mt,{class:"mt-3"}),(0,r.Wm)(bt,{class:"mt-3"})]),void 0,!0),_:1})])),"panel-main":(0,r.w5)((()=>[(0,r._)("div",kt,[null!=(0,r.SU)(e)?((0,r.wg)(),(0,r.j4)(dt,{key:0,category:(0,r.SU)(e)},null,8,["category"])):(0,r.kq)("",!0)])])),_:1})}}};const _t=St;var xt=_t;const It=[{path:"/",name:"ArticlesListPage",component:xt},{path:"/categories/:categoryId/articles/create",name:"ArticleCreatePage",component:()=>a.e(525).then(a.bind(a,4370))},{path:"/articles/:id/edit",name:"ArticleEditPage",component:()=>a.e(525).then(a.bind(a,1680))},{path:"/articles/:id/read",name:"ArticleReadPage",component:()=>a.e(525).then(a.bind(a,7033))},{path:"/categories",name:"CategoryPage",component:()=>a.e(267).then(a.bind(a,8994))},{path:"/categories/:id/import",name:"CategoryImportPage",component:()=>a.e(267).then(a.bind(a,5825))},{path:"/categories/:categoryId/setting",name:"CategorySettingPage",component:()=>a.e(267).then(a.bind(a,4265))},{path:"/settings",name:"SettingPage",component:()=>a.e(571).then(a.bind(a,511))}],Tt=(0,n.p7)({history:(0,n.r5)(),routes:It});var At=Tt},9446:function(t,e,a){a.d(e,{Z:function(){return b},m:function(){return w}});a(825);var n=a(1033),r=a(3612);class i{fromArticles(t){return t.map((t=>{const e=null==t.text?null:t.text.match("^https?://[^ \r\n\t]+"),a=null==e?null:e[0];return{expanded:!1,url:a,...t}}))}}var s=a(7370),o=a(5191),c=a(4793),l=a(4559);class d{constructor(t){this.categoryRepository=t}async setSettings(t,{articlesViewMode:e,tagPosition:a,tagSelectionMode:n}){const r=await this.categoryRepository.get(t);if(null==r)throw console.error("Specified categoryId not found. categoryId:",t),new Error("Specified categoryId not found. categoryId: "+t);const i={...r,categoryId:t,articlesViewMode:e??r.articlesViewMode,tagPosition:a??r.tagPosition,tagSelectionMode:n??r.tagSelectionMode};try{await this.categoryRepository.put(i),console.log("保存しました(service):",i)}catch(s){console.error("カテゴリーを保存できませんでした。",s.stack||s)}}}var u=a(9866),g={namespaced:!0,state:()=>({article:null,articleId:null}),mutations:{setArticle(t,e){const a=null==e||null==e.text?null:u.T.parse(e.text);t.article={html:a,...e}},setArticleId(t,e){t.articleId=e}},actions:{async loadSetting({commit:t,rootGetters:e}){const{articleService:a,settingService:n}=e.getDependances(),{articleId:r}=await n.getSidebarSetting();if(null==r)return t("setArticleId",null),void t("setArticle",null);const i=await a.get({articleId:r}),s=i[0];t("setArticleId",r),t("setArticle",s)},async setArticleId({commit:t,rootGetters:e},a){const{settingService:n}=e.getDependances();await n.setSidebarArticleId(a),t("setArticleId",a)}}};const p=new i,f=new o.Z,m=new s.Z(f),y=new l.Z(f),h=new d(y),v=new c.Z(m,y),w={articlesDatabase:f,articleRepository:m,articleService:v,settingService:null};n.ZP.use(r.ZP);var b=new r.ZP.Store({state:{articles:[],categoryId:null,categories:[],selectedTagTexts:[]},getters:{allTags(t){const e=t.articles.map((t=>t.tags??[])).reduce(((t,e)=>(e.filter((e=>!1===t.includes(e))).forEach((e=>t.push(e))),t)),[]);return e.map((e=>{const a=t.selectedTagTexts.includes(e);return{selected:a,text:e,value:e}}))},getDependances(){return()=>({...w})}},mutations:{selectTagText(t,{text:e,selected:a}){const n=t.categories.filter((e=>e.id===t.categoryId)),r=n[0]?.tagSelectionMode??"single",i=t.selectedTagTexts.includes(e);"single"!==r?i?!1===a&&(t.selectedTagTexts=t.selectedTagTexts.filter((t=>t!==e))):a&&t.selectedTagTexts.push(e):t.selectedTagTexts=i?[]:[e]},setArticleExpand(t,{id:e,expanded:a}){t.articles.filter((t=>t.id===e)).forEach((t=>{t.expanded=a}))},setArticles(t,e){t.articles=e},setCategories(t,{autoSelect:e,categories:a}){t.categories=a,a.length>0&&null==t.categoryId&&(t.categoryId=a[0].id)},setCategoryId(t,e){t.categoryId=e,t.selectedTagTexts=[]},setCategorySettings(t,{categoryId:e,articlesViewMode:a,tagPosition:n,tagSelectionMode:r}){t.categories.filter((t=>t.id===e)).forEach((t=>{t.articlesViewMode=a??t.articlesViewMode,t.tagPosition=n??t.tagPosition,t.tagSelectionMode=r??t.tagSelectionMode}))}},actions:{async exportArticles(t,{categoryId:e}){const a=await v.get({categoryId:e});m.export(a)},async loadArticles(t,e){const a=await v.get({categoryId:e}),n=p.fromArticles(a);t.commit("setArticles",n),t.commit("setCategoryId",e)},async loadCategories({commit:t,dispatch:e,state:a}){const n=await y.getAll();t("setCategories",{autoSelect:!0,categories:n}),null!=a.categoryId&&await e("loadArticles",a.categoryId)},setArticleExpanded(t,{id:e,expanded:a}){t.commit("setArticleExpand",{id:e,expanded:a}),v.setExpanding(e,a)},async setArticlesViewModeToCategory(t,{categoryId:e,articlesViewMode:a}){t.commit("setCategorySettings",{categoryId:e,articlesViewMode:a}),await h.setSettings(e,{articlesViewMode:a})},async setCategorySettings(t,{categoryId:e,tagPosition:a,tagSelectionMode:n}){t.commit("setCategorySettings",{categoryId:e,tagPosition:a,tagSelectionMode:n}),await h.setSettings(e,{tagPosition:a,tagSelectionMode:n})}},modules:{sidebar:g}})},4793:function(t,e,a){a.d(e,{Z:function(){return n}});class n{constructor(t,e){this.articleRepository=t,this.categoryRepository=e}async get({categoryId:t,articleId:e}){try{const a=await this.articleRepository.getArticles({categoryId:t,articleId:e}),n=a.map((t=>t.id)),r=await this.articleRepository.getArticleTags(n);return a.map((t=>this.getResult(t,r)))}catch(a){console.error("記事読み込めませんでした。",a)}}async set({id:t,categoryId:e,expanded:a,title:n,text:r,tags:i}){const s=await this.categoryRepository.get(e);if(null==s)throw console.error("Specified categoryId not found. categoryId:",e),new Error("Specified categoryId not found. categoryId: "+e);try{const s=await this.articleRepository.setArticle({id:t,categoryId:e,expanded:a,title:n,text:r});console.log("Inserted. articleId:",s);const o=await this.articleRepository.getArticleTags([s]);if(!this.areEqualTagsToArticleTags(i,o)){const t=o.map((t=>t.id));await this.articleRepository.deleteTagsFromArticle(t),await this.articleRepository.addTagsToArticle(s,i)}return s}catch(o){console.error("記事を保存できませんでした。",o.stack||o)}}async setExpanding(t,e){try{const a=await this.articleRepository.getArticles({articleId:t});if(a.length<=0)throw new Error("Specified articleId not found. articleId: "+t);a[0].expanded=e,this.articleRepository.setArticle(a[0])}catch(a){console.error("記事を保存できませんでした。",a.stack||a)}}getResult(t,e){const a=e.filter((e=>e.articleId===t.id)).map((t=>t.tagText)),n=Array.from(new Set(a).values());return{...t,tags:n}}areEqualTagsToArticleTags(t,e){if(t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==e[a].tagText)return!1;return!0}}},9204:function(t,e,a){a.d(e,{Z:function(){return l}});var n=a(1033);const r={class:"alert alert-warning"};function i(t,e){return(0,n.wg)(),(0,n.iD)("div",r," データがありません。 ")}var s=a(3615);const o={},c=(0,s.Z)(o,[["render",i]]);var l=c}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,a),i.exports}a.m=t,function(){var t=[];a.O=function(e,n,r,i){if(!n){var s=1/0;for(d=0;d<t.length;d++){n=t[d][0],r=t[d][1],i=t[d][2];for(var o=!0,c=0;c<n.length;c++)(!1&i||s>=i)&&Object.keys(a.O).every((function(t){return a.O[t](n[c])}))?n.splice(c--,1):(o=!1,i<s&&(s=i));if(o){t.splice(d--,1);var l=r();void 0!==l&&(e=l)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[n,r,i]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(e,n){return a.f[n](t,e),e}),[]))}}(),function(){a.u=function(t){return"js/"+{267:"categories",525:"articles",571:"settings"}[t]+"."+{267:"6477cce0",525:"63fa3817",571:"fe392c10"}[t]+".js"}}(),function(){a.miniCssF=function(t){return"css/articles.7fa173b7.css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="portal:";a.l=function(n,r,i,s){if(t[n])t[n].push(r);else{var o,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==e+i){o=u;break}}o||(c=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",e+i),o.src=n),t[n]=[r];var g=function(e,a){o.onerror=o.onload=null,clearTimeout(p);var r=t[n];if(delete t[n],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((function(t){return t(a)})),e)return e(a)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=g.bind(null,o.onerror),o.onload=g.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.p=""}(),function(){if("undefined"!==typeof document){var t=function(t,e,a,n,r){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var s=function(a){if(i.onerror=i.onload=null,"load"===a.type)n();else{var s=a&&("load"===a.type?"missing":a.type),o=a&&a.target&&a.target.href||e,c=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=s,c.request=o,i.parentNode.removeChild(i),r(c)}};return i.onerror=i.onload=s,i.href=e,a?a.parentNode.insertBefore(i,a.nextSibling):document.head.appendChild(i),i},e=function(t,e){for(var a=document.getElementsByTagName("link"),n=0;n<a.length;n++){var r=a[n],i=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(i===t||i===e))return r}var s=document.getElementsByTagName("style");for(n=0;n<s.length;n++){r=s[n],i=r.getAttribute("data-href");if(i===t||i===e)return r}},n=function(n){return new Promise((function(r,i){var s=a.miniCssF(n),o=a.p+s;if(e(s,o))return r();t(n,o,null,r,i)}))},r={143:0};a.f.miniCss=function(t,e){var a={525:1};r[t]?e.push(r[t]):0!==r[t]&&a[t]&&e.push(r[t]=n(t).then((function(){r[t]=0}),(function(e){throw delete r[t],e})))}}}(),function(){var t={143:0};a.f.j=function(e,n){var r=a.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise((function(a,n){r=t[e]=[a,n]}));n.push(r[2]=i);var s=a.p+a.u(e),o=new Error,c=function(n){if(a.o(t,e)&&(r=t[e],0!==r&&(t[e]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;o.message="Loading chunk "+e+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,r[1](o)}};a.l(s,c,"chunk-"+e,e)}},a.O.j=function(e){return 0===t[e]};var e=function(e,n){var r,i,s=n[0],o=n[1],c=n[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(r in o)a.o(o,r)&&(a.m[r]=o[r]);if(c)var d=c(a)}for(e&&e(n);l<s.length;l++)i=s[l],a.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return a.O(d)},n=self["webpackChunkportal"]=self["webpackChunkportal"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(767)}));n=a.O(n)})();
//# sourceMappingURL=app.ce712445.js.map