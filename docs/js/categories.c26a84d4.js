"use strict";(self["webpackChunkportal"]=self["webpackChunkportal"]||[]).push([[267],{647:function(e,t,o){o.r(t),o.d(t,{default:function(){return f}});var a=o(1033);const l={class:"h-100"},r={key:1,class:"h-100"},n={class:"d-flex"};function i(e,t,o,i,c,s){const d=(0,a.resolveComponent)("TheSidebar"),u=(0,a.resolveComponent)("NotFoundAlert"),m=(0,a.resolveComponent)("b-form-file"),p=(0,a.resolveComponent)("b-form-group"),g=(0,a.resolveComponent)("b-button"),h=(0,a.resolveComponent)("b-badge"),C=(0,a.resolveComponent)("b-list-group-item"),y=(0,a.resolveComponent)("b-list-group"),v=(0,a.resolveComponent)("TheMainLayout");return(0,a.openBlock)(),(0,a.createBlock)(v,{"main-panel-scroll":""},{sidebar:(0,a.withCtx)((()=>[(0,a.createVNode)(d)])),"panel-main":(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",l,[null==c.category?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0})):((0,a.openBlock)(),(0,a.createElementBlock)("div",r,[(0,a.createElementVNode)("h2",null,"記事を"+(0,a.toDisplayString)(c.category.title)+"にインポート",1),(0,a.createVNode)(p,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{modelValue:c.file,"onUpdate:modelValue":t[0]||(t[0]=e=>c.file=e),value:c.file,onInput:s.fileSelect,accept:"application/json",placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here..."},null,8,["modelValue","value","onInput"])]),void 0,!0),_:1}),(0,a.createElementVNode)("div",n,[(0,a.createVNode)(p,{class:"ml-auto"},{default:(0,a.withCtx)((()=>[(0,a.withDirectives)((0,a.createVNode)(g,{disabled:s.importButton.disabled,variant:"primary",onClick:s.importButtonClick},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" 選択をインポート ")]),void 0,!0),_:1},8,["disabled","onClick"]),[[a.vShow,s.importButton.visible]])]),void 0,!0),_:1})]),(0,a.createVNode)(y,null,{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.articles,(e=>((0,a.openBlock)(),(0,a.createBlock)(C,{key:e.id,class:"d-flex"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",null,(0,a.toDisplayString)(e.title),1),e.completed?((0,a.openBlock)(),(0,a.createBlock)(h,{key:0,variant:"info",class:"ml-auto"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" 済 ")]),void 0,!0),_:1})):(0,a.createCommentVNode)("",!0)]),void 0,!0),_:2},1024)))),128))]),void 0,!0),_:1})]))])])),_:1})}class c{async parse(e){try{const t=await this.readFileAsText(e),o=JSON.parse(t).articles;return{succeeded:!0,articles:o}}catch(t){const e="ファイルの読み込みに失敗しました。";return console.log(e,t),{succeeded:!1,exception:t,message:e}}}async readFileAsText(e){return await new Promise((t=>{const o=new FileReader;o.onload=()=>t(o.result),o.readAsText(e)}))}}var s=o(7370),d=o(4793),u=o(5191),m=o(4559);const p=new u.Z,g=new m.Z(p),h=new c,C=new s.Z(p),y=new d.Z(C,g);var v={name:"CategoryImportPage",data(){return{articles:[],category:null,categoryId:null,file:null}},computed:{importButton(){const e=null==this.articles?0:this.articles.length,t=null==this.articles?0:this.articles.filter((e=>!e.completed)).length,o=t<=0||null==this.file,a=e>0&&null!=this.file;return{disabled:o,visible:a}}},watch:{$route(e){this.categoryId=parseInt(e.params.id),this.loadCategory()}},mounted(){this.categoryId=parseInt(this.$route.params.id),this.loadCategory()},methods:{async fileSelect(e){this.file=e;const{succeeded:t,articles:o}=await h.parse(e);t&&(this.articles=o.map((e=>({...e,completed:!1}))))},async importButtonClick(){this.articles.filter((e=>!e.computed)).forEach((async e=>{const{title:t,text:o,tags:a}=e,l=this.categoryId;await y.set({categoryId:l,title:t,text:o,tags:a}),e.completed=!0}))},async loadCategory(){this.category=await g.get(this.categoryId)}}},w=o(3615);const N=(0,w.Z)(v,[["render",i]]);var f=N},549:function(e,t,o){o.r(t),o.d(t,{default:function(){return N}});var a=o(1033);const l={class:"h-100"},r=(0,a.createElementVNode)("h2",null,"カテゴリー",-1),n={class:"section-new-card"},i=(0,a.createElementVNode)("h3",null,"新規作成",-1),c={class:"section-list"},s=(0,a.createElementVNode)("h3",null,"一覧",-1),d={class:"ml-auto h-interval"},u=(0,a.createElementVNode)("i",{class:"fas fa-download"},null,-1);function m(e,t,o,m,p,g){const h=(0,a.resolveComponent)("TheSidebar"),C=(0,a.resolveComponent)("b-input"),y=(0,a.resolveComponent)("b-form-group"),v=(0,a.resolveComponent)("b-button"),w=(0,a.resolveComponent)("b-card"),N=(0,a.resolveComponent)("router-link"),f=(0,a.resolveComponent)("TheMainLayout");return(0,a.openBlock)(),(0,a.createBlock)(f,{"main-panel-scroll":""},{sidebar:(0,a.withCtx)((()=>[(0,a.createVNode)(h)])),"panel-main":(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",l,[r,(0,a.createElementVNode)("section",n,[i,(0,a.createVNode)(w,{class:"card-new-category"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(y,{label:"名称"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{modelValue:g.cardNewCategoryName,"onUpdate:modelValue":t[0]||(t[0]=e=>g.cardNewCategoryName=e)},null,8,["modelValue"])]),void 0,!0),_:1}),(0,a.createVNode)(y,{"label-sr-only":"",class:"mb-0"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(v,{disabled:g.cardNewCategoryCreateButtonDisabled,variant:"primary",onClick:g.createCategoryButtonClick},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" 作成 ")]),void 0,!0),_:1},8,["disabled","onClick"])]),void 0,!0),_:1})]),void 0,!0),_:1})]),(0,a.createElementVNode)("section",c,[s,((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.$store.state.categories,(e=>((0,a.openBlock)(),(0,a.createBlock)(w,{key:e.id,"body-class":"d-flex"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",null,(0,a.toDisplayString)(e.title),1),(0,a.createElementVNode)("div",d,[(0,a.createVNode)(N,{to:{name:"CategoryImportPage",params:{id:e.id}}},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" インポート ")]),void 0,!0),_:2},1032,["to"]),(0,a.createVNode)(v,{variant:"info",onClick:t=>g.exportButtonClick(e)},{default:(0,a.withCtx)((()=>[u,(0,a.createTextVNode)(" エクスポート ")]),void 0,!0),_:2},1032,["onClick"])])]),void 0,!0),_:2},1024)))),128))])])])),_:1})}var p=o(5191),g=o(4559);const h=new p.Z,C=new g.Z(h);var y={name:"CategoryPage",computed:{cardNewCategoryCreateButtonDisabled(){const{created:e,name:t}=this.cardNewCategory;return e||null==t||t.length<=0},cardNewCategoryName:{get(){return this.cardNewCategory.name},set(e){this.cardNewCategory.name=e,this.cardNewCategory.created=!1}}},data(){return{cardNewCategory:{created:!1,name:""}}},mounted(){this.$store.dispatch("loadCategories")},methods:{async createCategoryButtonClick(){this.cardNewCategory.created=!0;const e=this.cardNewCategory.name,t="single",o=await C.put({title:e,tagSelectionMode:t});console.log("Category created. categoryId:",o),this.$store.dispatch("loadCategories")},async exportButtonClick(e){const t=e.id;this.$store.dispatch("exportArticles",{categoryId:t})}}},v=o(3615);const w=(0,v.Z)(y,[["render",m]]);var N=w},4686:function(e,t,o){o.r(t),o.d(t,{default:function(){return g}});var a=o(1033);const l={slot:"panel-main",class:"h-100"},r={key:1,class:"h-100"};function n(e,t,o,n,i,c){const s=(0,a.resolveComponent)("TheSidebar"),d=(0,a.resolveComponent)("NotFoundAlert"),u=(0,a.resolveComponent)("b-radio-group"),m=(0,a.resolveComponent)("b-form-group"),p=(0,a.resolveComponent)("b-form"),g=(0,a.resolveComponent)("TheMainLayout");return(0,a.openBlock)(),(0,a.createBlock)(g,{"main-panel-scroll":""},{sidebar:(0,a.withCtx)((()=>[(0,a.createVNode)(s)])),"panel-main":(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",l,[null==i.category?((0,a.openBlock)(),(0,a.createBlock)(d,{key:0})):((0,a.openBlock)(),(0,a.createElementBlock)("div",r,[(0,a.createElementVNode)("h2",null,(0,a.toDisplayString)(i.category.title)+"の設定",1),(0,a.createVNode)(p,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{label:"タグの選択","label-cols":"4"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{name:"tagsSelection",options:i.tagSelection.options,modelValue:c.tagSelectionSelected,"onUpdate:modelValue":t[0]||(t[0]=e=>c.tagSelectionSelected=e)},null,8,["options","modelValue"])]),void 0,!0),_:1}),(0,a.createVNode)(m,{label:"タグの表示位置","label-cols":"4"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{name:"tagsPosition",options:i.tagsPosition.options,modelValue:c.tagPositionSelected,"onUpdate:modelValue":t[1]||(t[1]=e=>c.tagPositionSelected=e)},null,8,["options","modelValue"])]),void 0,!0),_:1})]),void 0,!0),_:1})]))])])),_:1})}var i=o(5191),c=o(4559);const s=new i.Z,d=new c.Z(s);var u={name:"CategorySettingPage",data(){return{category:null,categoryId:null,tagsPosition:{options:[{text:"タイトルの右",value:"right"},{text:"タイトルの下",value:"bottom"}]},tagSelection:{options:[{text:"最大1個",value:"single"},{text:"複数",value:"multiple"}]}}},computed:{tagPositionSelected:{get(){return this.category?.tagPosition??"right"},async set(e){const{categoryId:t}=this;await this.$store.dispatch("setCategorySettings",{categoryId:t,tagPosition:e}),await this.loadCategory()}},tagSelectionSelected:{get(){return this.category?.tagSelectionMode??"single"},async set(e){const{categoryId:t}=this;await this.$store.dispatch("setCategorySettings",{categoryId:t,tagSelectionMode:e}),await this.loadCategory()}}},watch:{$route(e){this.categoryId=parseInt(e.params.categoryId),this.loadCategory()}},mounted(){this.categoryId=parseInt(this.$route.params.categoryId),this.loadCategory()},methods:{async loadCategory(){this.category=await d.get(this.categoryId)}}},m=o(3615);const p=(0,m.Z)(u,[["render",n]]);var g=p}}]);
//# sourceMappingURL=categories.c26a84d4.js.map