(function(){"use strict";var e={7370:function(e,t,a){a.d(t,{Z:function(){return c}});var o=a(8090),n=a.n(o),r=a(4769),i=a.n(r);n().extend(i());class c{constructor(e){this.database=e.instance}async addTagsToArticle(e,t){const a=t.map((t=>({articleId:e,tagText:t})));await this.database.articleTags.bulkPut(a)}async deleteTagsFromArticle(e){await this.database.articleTags.bulkDelete(e)}export(e){const t=JSON.stringify({articles:e},null,2),a=new Blob([t],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(a),o.target="_blank",o.download="Articles.json",document.body.appendChild(o),o.click(),document.body.removeChild(o)}async getArticles({categoryId:e,articleId:t}){return await this.database.articles.filter((a=>(null==e||a.categoryId===e)&&(null==t||a.id===t))).toArray()}async getArticleTags(e){return await this.database.articleTags.filter((t=>e.includes(t.articleId))).toArray()}async getTagTexts(e){return await this.database.articleTags.filter((t=>t.articleId===e)).toArray()}async setArticle({id:e,categoryId:t,expanded:a,title:o,text:r}){const i=n().utc().format();return await this.database.articles.put({id:e,categoryId:t,expanded:a,title:o,text:r,updatedOn:i})}}},5191:function(e,t,a){a.d(t,{Z:function(){return n}});var o=a(2420);class n{constructor(){this.instance=new o.ZP("articlesDatabase"),this.instance.version(2).stores({articles:"++id, categoryId, title, text, createdOn, updatedOn",articleTags:"++id, articleId, tagText",categories:"++id, title",settings:"name"}),this.instance.version(1).stores({articles:"++id, categoryId, title, text, createdOn, updatedOn",articleTags:"++id, articleId, tagText",categories:"++id, title"})}delete(){o.ZP["delete"]("articlesDatabase")}}},4559:function(e,t,a){a.d(t,{Z:function(){return o}});class o{constructor(e){this.database=e.instance}async get(e){return await this.database.categories.get(e)}async getAll(){return this.database.categories.toArray()}async put({categoryId:e,title:t,icon:a,articlesViewMode:o,tagPosition:n,tagSelectionMode:r}){try{const i=await this.database.categories.put({id:e,title:t,icon:a,articlesViewMode:o,tagPosition:n,tagSelectionMode:r});return console.log("Inserted. categoryId:",i),i}catch(i){console.error(i.stack||i)}}}},9866:function(e,t,a){a.d(t,{T:function(){return o.TU}});var o=a(9747);const n=new o.TU.Renderer,r=n.link;n.link=(e,t,a)=>{const o=e.startsWith(`${location.protocol}//${location.hostname}`),i=r.call(n,e,t,a);return o?i:i.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')},o.TU.setOptions({renderer:n})},2162:function(e,t,a){var o=a(1033);const n={id:"app"};function r(e,t){const a=(0,o.resolveComponent)("router-view");return(0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createVNode)(a)])}var i=a(3615);const c={},l=(0,i.Z)(c,[["render",r]]);var s=l,d=a(2415);const u={class:"h-100"};function g(e,t,a,n,r,i){const c=(0,o.resolveComponent)("NavCategories"),l=(0,o.resolveComponent)("FormGroupTagButtons"),s=(0,o.resolveComponent)("TheSidebar"),d=(0,o.resolveComponent)("ArticleListPageMainPanel"),g=(0,o.resolveComponent)("TheMainLayout");return(0,o.openBlock)(),(0,o.createBlock)(g,{"main-panel-scroll":""},{sidebar:(0,o.withCtx)((()=>[(0,o.createVNode)(s,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{class:"mt-3"}),(0,o.createVNode)(l,{class:"mt-3"})]),void 0,!0),_:1})])),"panel-main":(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",u,[null!=i.selectedCategory?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0,category:i.selectedCategory},null,8,["category"])):(0,o.createCommentVNode)("",!0)])])),_:1})}var m=a(3612);const p={class:"h-100"},h={class:"d-flex"},v={class:"ml-auto"},f={class:"command-bar d-flex justify-content-end"},y={class:"alerts pt-3"},k={key:0,class:"pt-3"};function C(e,t,a,n,r,i){const c=(0,o.resolveComponent)("ButtonCategorySettingPage"),l=(0,o.resolveComponent)("ButtonArticleCreatePage"),s=(0,o.resolveComponent)("b-form-group"),d=(0,o.resolveComponent)("NavArticleViewMode"),u=(0,o.resolveComponent)("b-alert"),g=(0,o.resolveComponent)("ArticlePanel"),m=(0,o.resolveComponent)("CampactLinksPanel");return(0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createElementVNode)("div",h,[(0,o.createElementVNode)("h2",null,(0,o.toDisplayString)(a.category.title),1),(0,o.createElementVNode)("div",v,[(0,o.createVNode)(s,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{"category-id":a.category.id},null,8,["category-id"]),(0,o.createVNode)(l,{"category-id":a.category.id},null,8,["category-id"])]),void 0,!0),_:1})])]),(0,o.createElementVNode)("div",f,[(0,o.createVNode)(d,{mode:i.mode,onChange:i.navViewModeChange},null,8,["mode","onChange"])]),(0,o.createElementVNode)("div",y,[(0,o.createVNode)(u,{show:i.alertCompactOnlyVisible,variant:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" 詳細モードで可能な記事がありません。コンパクトモードであれば表示できます。 ")]),void 0,!0),_:1},8,["show"]),(0,o.createVNode)(u,{show:i.alertDetailOnlyVisible,variant:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" コンパクトモードで可能な記事がありません。詳細モードであれば表示できます。 ")]),void 0,!0),_:1},8,["show"]),(0,o.createVNode)(u,{show:i.alertNoArticle,variant:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" 検索条件に合致する記事がありません。 ")]),void 0,!0),_:1},8,["show"])]),i.modeDetailActive?((0,o.openBlock)(),(0,o.createElementBlock)("div",k,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(i.articles,(e=>((0,o.openBlock)(),(0,o.createBlock)(g,{key:e.id,article:e,tagPosition:a.category.tagPosition,onExpand:t=>i.articleExpand(e,t)},null,8,["article","tagPosition","onExpand"])))),128))])):(0,o.createCommentVNode)("",!0),i.modeCompactActive?((0,o.openBlock)(),(0,o.createBlock)(m,{key:1,table:i.table,class:"pt-3"},null,8,["table"])):(0,o.createCommentVNode)("",!0)])}const b={class:"d-flex align-items-center"},w={class:"mr-auto d-flex flex-column"},x={class:"title"},B={key:0},T=["href"],A={key:0,class:"tags"},V={key:0,class:"tags pr-2 h-interval"},N={class:"right-side"},S={key:0,class:"pr-2 d-inline-block h-interval"},E=(0,o.createElementVNode)("i",{class:"far fa-newspaper"},null,-1),I=(0,o.createElementVNode)("i",{class:"fas fa-edit"},null,-1),P=["innerHTML"];function M(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-badge"),l=(0,o.resolveComponent)("ButtonExpand"),s=(0,o.resolveComponent)("b-button"),d=(0,o.resolveComponent)("b-card");return(0,o.openBlock)(),(0,o.createBlock)(d,{"body-class":"py-2"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",b,[(0,o.createElementVNode)("div",w,[(0,o.createElementVNode)("div",x,[null==a.article.url?((0,o.openBlock)(),(0,o.createElementBlock)("span",B,(0,o.toDisplayString)(a.article.title),1)):((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:1,href:a.article.url,target:"_blank"},(0,o.toDisplayString)(a.article.title),9,T))]),i.bottomTagsVisible?((0,o.openBlock)(),(0,o.createElementBlock)("div",A,[null!=a.article.tags?((0,o.openBlock)(),(0,o.createElementBlock)("div",V,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.article.tags,(e=>((0,o.openBlock)(),(0,o.createBlock)(c,{key:e,variant:"info"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e),1)]),void 0,!0),_:2},1024)))),128))])):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0)]),(0,o.createElementVNode)("div",N,[i.bottomTagsVisible||null==a.article.tags?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",S,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.article.tags,(e=>((0,o.openBlock)(),(0,o.createBlock)(c,{key:e,variant:"info"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e),1)]),void 0,!0),_:2},1024)))),128))])),i.expandButtonVisible?((0,o.openBlock)(),(0,o.createBlock)(l,{key:1,expanded:i.expanded,onClick:i.expandButtonClick},null,8,["expanded","onClick"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(s,{variant:"link",to:{name:"ArticleReadPage",params:{id:a.article.id}}},{default:(0,o.withCtx)((()=>[E]),void 0,!0),_:1},8,["to"]),(0,o.createVNode)(s,{variant:"link",to:{name:"ArticleEditPage",params:{id:a.article.id}}},{default:(0,o.withCtx)((()=>[I]),void 0,!0),_:1},8,["to"])])]),(0,o.withDirectives)((0,o.createElementVNode)("div",{innerHTML:i.bodyHtml,class:"article-body-view"},null,8,P),[[o.vShow,i.expanded]])]),void 0,!0),_:1})}var _=a(9866);const L={key:0,class:"fas fa-arrow-circle-down"},D={key:1,class:"fas fa-arrow-circle-up"};function O(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-button");return(0,o.openBlock)(),(0,o.createBlock)(c,{variant:"link",class:"p-0",onClick:i.buttonClick},{default:(0,o.withCtx)((()=>[a.expanded?((0,o.openBlock)(),(0,o.createElementBlock)("i",L)):((0,o.openBlock)(),(0,o.createElementBlock)("i",D))]),void 0,!0),_:1},8,["onClick"])}var Z={name:"ButtonExpand",props:{expanded:Boolean},methods:{buttonClick(){this.$emit("click")}}};const $=(0,i.Z)(Z,[["render",O]]);var R=$,F={name:"ArticlePanel",components:{ButtonExpand:R},props:{article:{type:Object,required:!0},tagPosition:{default:"right",type:String}},computed:{bodyHtml(){return _.T.parse(this.article.text)},expandButtonVisible(){return null!=this.article.text&&this.article.text.length>0},expanded(){return!0===this.article.expanded},bottomTagsVisible(){return"bottom"===this.tagPosition}},methods:{expandButtonClick(){this.$emit("expand",!this.expanded)}}};const j=(0,i.Z)(F,[["render",M]]);var H=j;const q=(0,o.createElementVNode)("i",{class:"fas fa-plus"},null,-1);function U(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-button");return(0,o.openBlock)(),(0,o.createBlock)(c,{variant:"link",to:{name:"ArticleCreatePage",params:{categoryId:a.categoryId}}},{default:(0,o.withCtx)((()=>[q]),void 0,!0),_:1},8,["to"])}var G={name:"ButtonArticleCreatePage",props:{categoryId:Number}};const z=(0,i.Z)(G,[["render",U]]);var J=z;const K=(0,o.createElementVNode)("i",{class:"fas fa-cog"},null,-1);function W(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-button");return(0,o.openBlock)(),(0,o.createBlock)(c,{variant:"link",to:{name:"CategorySettingPage",params:{categoryId:a.categoryId}}},{default:(0,o.withCtx)((()=>[K]),void 0,!0),_:1},8,["to"])}var Q={name:"ButtonCategorySettingPage",props:{categoryId:Number}};const X=(0,i.Z)(Q,[["render",W]]);var Y=X;const ee=["href"];function te(e,t,a,n,r,i){return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.table,(e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:e.text,class:"h-interval"},[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.text),1),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.articles,(e=>((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:e.id,href:e.url,target:"_blank"},(0,o.toDisplayString)(e.title),9,ee)))),128))])))),128))])}var ae={name:"CampactLinksPanel",props:{table:Array}};const oe=(0,i.Z)(ae,[["render",te]]);var ne=oe;function re(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-nav-item"),l=(0,o.resolveComponent)("b-nav");return(0,o.openBlock)(),(0,o.createBlock)(l,{pills:"",small:""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{active:i.modeCompactActive,onClick:i.modeCompactNavClick},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" コンパクト ")]),void 0,!0),_:1},8,["active","onClick"]),(0,o.createVNode)(c,{active:i.modeDetailActive,onClick:i.modeDetailNavClick},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" 詳細 ")]),void 0,!0),_:1},8,["active","onClick"])]),void 0,!0),_:1})}var ie={name:"NavArticleViewMode",props:{mode:String},computed:{modeCompactActive(){return"compact"===this.mode},modeDetailActive(){return"detail"===this.mode}},methods:{modeCompactNavClick(){this.$emit("change","compact")},modeDetailNavClick(){this.$emit("change","detail")}}};const ce=(0,i.Z)(ie,[["render",re]]);var le=ce;a(825);class se{create(e,t){const a=this.getArticles(e,t),o=this.getTags(a);return this.getTable(a,o)}getArticles(e,t){return e.filter((e=>null!=e.url)).filter((e=>this.isTargetArticle(e,t)))}isTargetArticle(e,t){return null==t||t.length<=0||null!=e.tags&&t.every((t=>e.tags.includes(t)))}getTags(e){const t=e.some((e=>null==e.tags||e.tags.length<=0)),a=t?[{text:"（タグなし）",value:null}]:[],o=e.map((e=>e.tags)).reduce(((e,t)=>(t.forEach((t=>{!1===e.includes(t)&&e.push(t)})),e)),[]).map((e=>({text:e,value:e})));return[...a,...o]}getTable(e,t){return t.map((t=>{const a=e.filter((e=>null==t.value?null==e.tags||e.tags.length<=0:null!=e.tags&&e.tags.includes(t.value)));return{...t,articles:a}}))}}const de=new se;var ue={name:"ArticleListPageMainPanel",components:{ArticlePanel:H,ButtonArticleCreatePage:J,ButtonCategorySettingPage:Y,CampactLinksPanel:ne,NavArticleViewMode:le},props:{category:{type:Object,required:!0}},computed:{alertCompactOnlyVisible(){return this.modeDetailActive&&this.articles.length<=0&&this.table.length>0},alertDetailOnlyVisible(){return this.modeCompactActive&&this.articles.length>0&&this.table.length<=0},alertNoArticle(){return this.articles.length<=0&&this.table.length<=0},articles(){const{articles:e,selectedTagTexts:t}=this.$store.state;return e.filter((e=>de.isTargetArticle(e,t)))},mode(){return"detail"===this.category.articlesViewMode?"detail":"compact"},modeCompactActive(){return"compact"===this.mode},modeDetailActive(){return"detail"===this.mode},table(){const{articles:e,selectedTagTexts:t}=this.$store.state;return de.create(e,t)}},methods:{articleExpand(e,t){const{id:a}=e;this.$store.dispatch("setArticleExpanded",{id:a,expanded:t})},navViewModeChange(e){const t=this.category.id;this.$store.dispatch("setArticlesViewModeToCategory",{categoryId:t,articlesViewMode:e})}}};const ge=(0,i.Z)(ue,[["render",C]]);var me=ge;function pe(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-nav-item"),l=(0,o.resolveComponent)("b-nav");return(0,o.openBlock)(),(0,o.createBlock)(l,{vertical:"",class:"nav-category"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(i.categories,(e=>((0,o.openBlock)(),(0,o.createBlock)(c,{key:e.id,active:e.active,onClick:t=>i.categorySelect(e)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.title),1)]),void 0,!0),_:2},1032,["active","onClick"])))),128))]),void 0,!0),_:1})}var he={name:"NavCategories",computed:{categories(){return this.$store.state.categories.map((e=>{const{id:t,title:a}=e,o=t===this.$store.state.categoryId;return{active:o,id:t,title:a}}))}},methods:{async categorySelect(e){null!=e&&(this.$store.commit("setCategoryId",e.id),await this.$store.dispatch("loadArticles",e.id))}}};const ve=(0,i.Z)(he,[["render",pe]]);var fe=ve;function ye(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-button"),l=(0,o.resolveComponent)("b-form-group");return(0,o.openBlock)(),(0,o.createBlock)(l,null,{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(i.tagButtons,(e=>((0,o.openBlock)(),(0,o.createBlock)(c,{key:e.text,variant:e.variant,size:"sm",onClick:t=>i.tagButtonClick(e)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.text),1)]),void 0,!0),_:2},1032,["variant","onClick"])))),128))]),void 0,!0),_:1})}var ke={name:"FormGroupTagButtons",computed:{tagButtons(){return this.allTags.map((e=>{const{selected:t,text:a}=e,o=t?"info":"outline-info";return{selected:t,text:a,variant:o}}))},...(0,m.Se)(["allTags"])},methods:{tagButtonClick(e){const{text:t,selected:a}=e;this.$store.commit("selectTagText",{text:t,selected:!a})}}};const Ce=(0,i.Z)(ke,[["render",ye]]);var be=Ce,we={name:"ArticlesListPage",components:{ArticleListPageMainPanel:me,FormGroupTagButtons:be,NavCategories:fe},computed:{...(0,m.rn)(["categories","categoryId"]),selectedCategory(){return this.categories.filter((e=>e.id===this.categoryId))[0]}},async mounted(){this.$store.dispatch("loadCategories")}};const xe=(0,i.Z)(we,[["render",g]]);var Be=xe;const Te=[{path:"/",name:"ArticlesListPage",component:Be},{path:"/categories/:categoryId/articles/create",name:"ArticleCreatePage",component:()=>a.e(525).then(a.bind(a,5603))},{path:"/articles/:id/edit",name:"ArticleEditPage",component:()=>a.e(525).then(a.bind(a,1429))},{path:"/articles/:id/read",name:"ArticleReadPage",component:()=>a.e(525).then(a.bind(a,8664))},{path:"/categories",name:"CategoryPage",component:()=>a.e(267).then(a.bind(a,549))},{path:"/categories/:id/import",name:"CategoryImportPage",component:()=>a.e(267).then(a.bind(a,647))},{path:"/categories/:categoryId/setting",name:"CategorySettingPage",component:()=>a.e(267).then(a.bind(a,4686))},{path:"/settings",name:"SettingPage",component:()=>a.e(571).then(a.bind(a,8317))}],Ae=(0,d.p7)({history:(0,d.r5)(),routes:Te});var Ve=Ae;class Ne{fromArticles(e){return e.map((e=>{const t=null==e.text?null:e.text.match("^https?://[^ \r\n\t]+"),a=null==t?null:t[0];return{expanded:!1,url:a,...e}}))}}var Se=a(7370),Ee=a(5191),Ie=a(4793),Pe=a(4559);class Me{constructor(e){this.categoryRepository=e}async setSettings(e,{articlesViewMode:t,tagPosition:a,tagSelectionMode:o}){const n=await this.categoryRepository.get(e);if(null==n)throw console.error("Specified categoryId not found. categoryId:",e),new Error("Specified categoryId not found. categoryId: "+e);const r={...n,categoryId:e,articlesViewMode:t??n.articlesViewMode,tagPosition:a??n.tagPosition,tagSelectionMode:o??n.tagSelectionMode};try{await this.categoryRepository.put(r),console.log("保存しました(service):",r)}catch(i){console.error("カテゴリーを保存できませんでした。",i.stack||i)}}}var _e={namespaced:!0,state:()=>({article:null,articleId:null}),mutations:{setArticle(e,t){const a=null==t||null==t.text?null:_.T.parse(t.text);e.article={html:a,...t}},setArticleId(e,t){e.articleId=t}},actions:{async loadSetting({commit:e,rootGetters:t}){const{articleService:a,settingService:o}=t.getDependances(),{articleId:n}=await o.getSidebarSetting();if(null==n)return e("setArticleId",null),void e("setArticle",null);const r=await a.get({articleId:n}),i=r[0];e("setArticleId",n),e("setArticle",i)},async setArticleId({commit:e,rootGetters:t},a){const{settingService:o}=t.getDependances();await o.setSidebarArticleId(a),e("setArticleId",a)}}};const Le=new Ne,De=new Ee.Z,Oe=new Se.Z(De),Ze=new Pe.Z(De),$e=new Me(Ze),Re=new Ie.Z(Oe,Ze),Fe={articlesDatabase:De,articleRepository:Oe,articleService:Re,settingService:null};o["default"].use(m.ZP);var je=new m.ZP.Store({state:{articles:[],categoryId:null,categories:[],selectedTagTexts:[]},getters:{allTags(e){const t=e.articles.map((e=>e.tags??[])).reduce(((e,t)=>(t.filter((t=>!1===e.includes(t))).forEach((t=>e.push(t))),e)),[]);return t.map((t=>{const a=e.selectedTagTexts.includes(t);return{selected:a,text:t,value:t}}))},getDependances(){return()=>({...Fe})}},mutations:{selectTagText(e,{text:t,selected:a}){const o=e.categories.filter((t=>t.id===e.categoryId)),n=o[0]?.tagSelectionMode??"single",r=e.selectedTagTexts.includes(t);"single"!==n?r?!1===a&&(e.selectedTagTexts=e.selectedTagTexts.filter((e=>e!==t))):a&&e.selectedTagTexts.push(t):e.selectedTagTexts=r?[]:[t]},setArticleExpand(e,{id:t,expanded:a}){e.articles.filter((e=>e.id===t)).forEach((e=>{e.expanded=a}))},setArticles(e,t){e.articles=t},setCategories(e,{autoSelect:t,categories:a}){e.categories=a,a.length>0&&null==e.categoryId&&(e.categoryId=a[0].id)},setCategoryId(e,t){e.categoryId=t,e.selectedTagTexts=[]},setCategorySettings(e,{categoryId:t,articlesViewMode:a,tagPosition:o,tagSelectionMode:n}){e.categories.filter((e=>e.id===t)).forEach((e=>{e.articlesViewMode=a??e.articlesViewMode,e.tagPosition=o??e.tagPosition,e.tagSelectionMode=n??e.tagSelectionMode}))}},actions:{async exportArticles(e,{categoryId:t}){const a=await Re.get({categoryId:t});Oe.export(a)},async loadArticles(e,t){const a=await Re.get({categoryId:t}),o=Le.fromArticles(a);e.commit("setArticles",o),e.commit("setCategoryId",t)},async loadCategories({commit:e,dispatch:t,state:a}){const o=await Ze.getAll();e("setCategories",{autoSelect:!0,categories:o}),null!=a.categoryId&&await t("loadArticles",a.categoryId)},setArticleExpanded(e,{id:t,expanded:a}){e.commit("setArticleExpand",{id:t,expanded:a}),Re.setExpanding(t,a)},async setArticlesViewModeToCategory(e,{categoryId:t,articlesViewMode:a}){console.log("store...",{categoryId:t,articlesViewMode:a}),e.commit("setCategorySettings",{categoryId:t,articlesViewMode:a}),await $e.setSettings(t,{articlesViewMode:a})},async setCategorySettings(e,{categoryId:t,tagPosition:a,tagSelectionMode:o}){e.commit("setCategorySettings",{categoryId:t,tagPosition:a,tagSelectionMode:o}),await $e.setSettings(t,{tagPosition:a,tagSelectionMode:o})}},modules:{sidebar:_e}}),He=a(6895);a(235);function qe(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-alert");return(0,o.openBlock)(),(0,o.createBlock)(c,{variant:"warning",show:""},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" データがありません。 ")]),void 0,!0),_:1})}var Ue={name:"NotFoundAlert"};const Ge=(0,i.Z)(Ue,[["render",qe]]);var ze=Ge;const Je={class:"d-flex flex-column h-100"},Ke={class:"flex-grow-1 h-0"},We={class:"h-100"};function Qe(e,t,a,n,r,i){return(0,o.openBlock)(),(0,o.createElementBlock)("div",Je,[(0,o.renderSlot)(e.$slots,"header",{},void 0,!0),(0,o.createElementVNode)("div",Ke,[(0,o.createElementVNode)("div",We,[(0,o.renderSlot)(e.$slots,"default",{},void 0,!0)])]),(0,o.renderSlot)(e.$slots,"footer",{},void 0,!0)])}var Xe={};const Ye=(0,i.Z)(Xe,[["render",Qe],["__scopeId","data-v-bc4d3014"]]);var et=Ye;const tt={class:"h-100 pr-3"};function at(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-col"),l=(0,o.resolveComponent)("b-row"),s=(0,o.resolveComponent)("b-container");return(0,o.openBlock)(),(0,o.createBlock)(s,{fluid:"",class:"h-100 container-main"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{class:"h-100"},{default:(0,o.withCtx)((()=>[a.noSidebar?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(c,{key:0,cols:"12",sm:"4",md:"3",class:"h-100-sm sidebar pr-0"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",tt,[(0,o.renderSlot)(e.$slots,"sidebar")])]),void 0,!0),_:3})),(0,o.createVNode)(c,{cols:"12",sm:i.mainPanelSmCols,md:i.mainPanelMdCols,class:(0,o.normalizeClass)(i.mainPanelClass)},{default:(0,o.withCtx)((()=>[(0,o.renderSlot)(e.$slots,"panel-main")]),void 0,!0),_:3},8,["sm","md","class"])]),void 0,!0),_:3})]),void 0,!0),_:3})}var ot={props:{noSidebar:Boolean,mainPanelScroll:Boolean},computed:{mainPanelClass(){return{"h-100-sm":!0,"panel-main":!0,"overflow-auto":this.mainPanelScroll}},mainPanelSmCols(){return this.noSidebar?12:8},mainPanelMdCols(){return this.noSidebar?12:9}}};const nt=(0,i.Z)(ot,[["render",at]]);var rt=nt;const it=e=>((0,o.pushScopeId)("data-v-2bd5a978"),e=e(),(0,o.popScopeId)(),e),ct={class:"d-flex flex-column h-100"},lt=it((()=>(0,o.createElementVNode)("h1",{class:"h2"},[(0,o.createElementVNode)("span",null,"🏠"),(0,o.createElementVNode)("span",{class:"site-title-animals"},"🐕🦘🐬🐓🕊🦢")],-1))),st=it((()=>(0,o.createElementVNode)("div",{class:"mt-auto"},null,-1))),dt={key:0},ut=["innerHTML"],gt=it((()=>(0,o.createElementVNode)("i",{class:"far fa-newspaper"},null,-1))),mt=it((()=>(0,o.createElementVNode)("span",{class:"ml-2"},"記事",-1))),pt=it((()=>(0,o.createElementVNode)("i",{class:"far fa-folder-open"},null,-1))),ht=it((()=>(0,o.createElementVNode)("span",{class:"ml-2"},"カテゴリー",-1))),vt=it((()=>(0,o.createElementVNode)("i",{class:"fas fa-cog"},null,-1))),ft=it((()=>(0,o.createElementVNode)("span",{class:"ml-2"},"設定",-1)));function yt(e,t,a,n,r,i){const c=(0,o.resolveComponent)("b-button"),l=(0,o.resolveComponent)("b-form-group");return(0,o.openBlock)(),(0,o.createElementBlock)("div",ct,[lt,(0,o.renderSlot)(e.$slots,"default",{},void 0,!0),st,null!=i.sidebarArticle?((0,o.openBlock)(),(0,o.createElementBlock)("div",dt,[(0,o.createElementVNode)("div",{innerHTML:i.sidebarArticle.html},null,8,ut)])):(0,o.createCommentVNode)("",!0),"ArticlesListPage"!=e.$route.name?((0,o.openBlock)(),(0,o.createBlock)(l,{key:1},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{variant:"link",to:{name:"ArticlesListPage"}},{default:(0,o.withCtx)((()=>[gt,mt]),void 0,!0),_:1})]),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0),"CategoryPage"!=e.$route.name?((0,o.openBlock)(),(0,o.createBlock)(l,{key:2},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{variant:"link",to:{name:"CategoryPage"}},{default:(0,o.withCtx)((()=>[pt,ht]),void 0,!0),_:1})]),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0),"SettingPage"!=e.$route.name?((0,o.openBlock)(),(0,o.createBlock)(l,{key:3},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{variant:"link",to:{name:"SettingPage"}},{default:(0,o.withCtx)((()=>[vt,ft]),void 0,!0),_:1})]),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0)])}var kt={name:"TheSidebar",computed:{sidebarArticle(){return this.$store.state.sidebar.article}},async mounted(){null==this.$store.state.sidebar.articleId&&await this.$store.dispatch("sidebar/loadSetting")}};const Ct=(0,i.Z)(kt,[["render",yt],["__scopeId","data-v-2bd5a978"]]);var bt=Ct;class wt{constructor(e){this.database=e.instance}async get(e){return await this.database.settings.get(e)}async put(e){try{return await this.database.settings.put(e)}catch(t){console.error(t.stack??t)}}}class xt{constructor(e){this.settingRepository=e}async getSidebarSetting(){const{articleId:e}=await this.settingRepository.get("sidebar")??{};return{name:"sidebar",articleId:e}}async setSidebarArticleId(e){const t=await this.getSidebarSetting();t.articleId=e,console.log("service sidebar:",t),await this.settingRepository.put(t)}}o["default"].component("NotFoundAlert",ze),o["default"].component("FullHeight",et),o["default"].component("TheMainLayout",rt),o["default"].component("TheSidebar",bt),o["default"].config.productionTip=!1,o["default"].use(He.ZPm);const Bt=new wt(Fe.articlesDatabase),Tt=new xt(Bt);Fe.settingService=Tt,o["default"].createApp({render:e=>e(s)}).use(Ve).use(je).mount("#app")},4793:function(e,t,a){a.d(t,{Z:function(){return o}});class o{constructor(e,t){this.articleRepository=e,this.categoryRepository=t}async get({categoryId:e,articleId:t}){try{const a=await this.articleRepository.getArticles({categoryId:e,articleId:t}),o=a.map((e=>e.id)),n=await this.articleRepository.getArticleTags(o);return a.map((e=>this.getResult(e,n)))}catch(a){console.error("記事読み込めませんでした。",a)}}async set({id:e,categoryId:t,expanded:a,title:o,text:n,tags:r}){const i=await this.categoryRepository.get(t);if(null==i)throw console.error("Specified categoryId not found. categoryId:",t),new Error("Specified categoryId not found. categoryId: "+t);try{const i=await this.articleRepository.setArticle({id:e,categoryId:t,expanded:a,title:o,text:n});console.log("Inserted. articleId:",i);const c=await this.articleRepository.getArticleTags([i]);if(!this.areEqualTagsToArticleTags(r,c)){const e=c.map((e=>e.id));await this.articleRepository.deleteTagsFromArticle(e),await this.articleRepository.addTagsToArticle(i,r)}return i}catch(c){console.error("記事を保存できませんでした。",c.stack||c)}}async setExpanding(e,t){try{const a=await this.articleRepository.getArticles({articleId:e});if(a.length<=0)throw new Error("Specified articleId not found. articleId: "+e);a[0].expanded=t,this.articleRepository.setArticle(a[0])}catch(a){console.error("記事を保存できませんでした。",a.stack||a)}}getResult(e,t){const a=t.filter((t=>t.articleId===e.id)).map((e=>e.tagText)),o=Array.from(new Set(a).values());return{...e,tags:o}}areEqualTagsToArticleTags(e,t){if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!==t[a].tagText)return!1;return!0}}}},t={};function a(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,o,n,r){if(!o){var i=1/0;for(d=0;d<e.length;d++){o=e[d][0],n=e[d][1],r=e[d][2];for(var c=!0,l=0;l<o.length;l++)(!1&r||i>=r)&&Object.keys(a.O).every((function(e){return a.O[e](o[l])}))?o.splice(l--,1):(c=!1,r<i&&(i=r));if(c){e.splice(d--,1);var s=n();void 0!==s&&(t=s)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,n,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,o){return a.f[o](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+{267:"categories",525:"articles",571:"settings"}[e]+"."+{267:"c26a84d4",525:"b74b0f36",571:"e4cb4dda"}[e]+".js"}}(),function(){a.miniCssF=function(e){return"css/articles.8833921d.css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="portal:";a.l=function(o,n,r,i){if(e[o])e[o].push(n);else{var c,l;if(void 0!==r)for(var s=document.getElementsByTagName("script"),d=0;d<s.length;d++){var u=s[d];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==t+r){c=u;break}}c||(l=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,a.nc&&c.setAttribute("nonce",a.nc),c.setAttribute("data-webpack",t+r),c.src=o),e[o]=[n];var g=function(t,a){c.onerror=c.onload=null,clearTimeout(m);var n=e[o];if(delete e[o],c.parentNode&&c.parentNode.removeChild(c),n&&n.forEach((function(e){return e(a)})),t)return t(a)},m=setTimeout(g.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=g.bind(null,c.onerror),c.onload=g.bind(null,c.onload),l&&document.head.appendChild(c)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p=""}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,o,n){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css";var i=function(a){if(r.onerror=r.onload=null,"load"===a.type)o();else{var i=a&&("load"===a.type?"missing":a.type),c=a&&a.target&&a.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+c+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=i,l.request=c,r.parentNode.removeChild(r),n(l)}};return r.onerror=r.onload=i,r.href=t,a?a.parentNode.insertBefore(r,a.nextSibling):document.head.appendChild(r),r},t=function(e,t){for(var a=document.getElementsByTagName("link"),o=0;o<a.length;o++){var n=a[o],r=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(r===e||r===t))return n}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){n=i[o],r=n.getAttribute("data-href");if(r===e||r===t)return n}},o=function(o){return new Promise((function(n,r){var i=a.miniCssF(o),c=a.p+i;if(t(i,c))return n();e(o,c,null,n,r)}))},n={143:0};a.f.miniCss=function(e,t){var a={525:1};n[e]?t.push(n[e]):0!==n[e]&&a[e]&&t.push(n[e]=o(e).then((function(){n[e]=0}),(function(t){throw delete n[e],t})))}}}(),function(){var e={143:0};a.f.j=function(t,o){var n=a.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var r=new Promise((function(a,o){n=e[t]=[a,o]}));o.push(n[2]=r);var i=a.p+a.u(t),c=new Error,l=function(o){if(a.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var r=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;c.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",c.name="ChunkLoadError",c.type=r,c.request=i,n[1](c)}};a.l(i,l,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,r,i=o[0],c=o[1],l=o[2],s=0;if(i.some((function(t){return 0!==e[t]}))){for(n in c)a.o(c,n)&&(a.m[n]=c[n]);if(l)var d=l(a)}for(t&&t(o);s<i.length;s++)r=i[s],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},o=self["webpackChunkportal"]=self["webpackChunkportal"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[998],(function(){return a(2162)}));o=a.O(o)})();
//# sourceMappingURL=app.99be7e9f.js.map