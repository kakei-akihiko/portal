(function(){"use strict";var t={7370:function(t,e,a){a.d(e,{Z:function(){return o}});var i=a(8090),n=a.n(i),r=a(4769),s=a.n(r);n().extend(s());class o{constructor(t){this.database=t.instance}async addTagsToArticle(t,e){const a=e.map((e=>({articleId:t,tagText:e})));await this.database.articleTags.bulkPut(a)}async deleteTagsFromArticle(t){await this.database.articleTags.bulkDelete(t)}export(t){const e=JSON.stringify({articles:t},null,2),a=new Blob([e],{type:"application/json"}),i=document.createElement("a");i.href=URL.createObjectURL(a),i.target="_blank",i.download="Articles.json",document.body.appendChild(i),i.click(),document.body.removeChild(i)}async getArticles({categoryId:t,articleId:e}){return await this.database.articles.filter((a=>(null==t||a.categoryId===t)&&(null==e||a.id===e))).toArray()}async getArticleTags(t){return await this.database.articleTags.filter((e=>t.includes(e.articleId))).toArray()}async getTagTexts(t){return await this.database.articleTags.filter((e=>e.articleId===t)).toArray()}async setArticle({id:t,categoryId:e,expanded:a,title:i,text:r}){const s=n().utc().format();return await this.database.articles.put({id:t,categoryId:e,expanded:a,title:i,text:r,updatedOn:s})}}},5191:function(t,e,a){a.d(e,{Z:function(){return n}});var i=a(2420);class n{constructor(){this.instance=new i.ZP("articlesDatabase"),this.instance.version(2).stores({articles:"++id, categoryId, title, text, createdOn, updatedOn",articleTags:"++id, articleId, tagText",categories:"++id, title",settings:"name"}),this.instance.version(1).stores({articles:"++id, categoryId, title, text, createdOn, updatedOn",articleTags:"++id, articleId, tagText",categories:"++id, title"})}delete(){i.ZP["delete"]("articlesDatabase")}}},4559:function(t,e,a){a.d(e,{Z:function(){return i}});class i{constructor(t){this.database=t.instance}async get(t){return await this.database.categories.get(t)}async getAll(){return this.database.categories.toArray()}async put({categoryId:t,title:e,icon:a,articlesViewMode:i,tagPosition:n,tagSelectionMode:r}){try{const s=await this.database.categories.put({id:t,title:e,icon:a,articlesViewMode:i,tagPosition:n,tagSelectionMode:r});return console.log("Inserted. categoryId:",s),s}catch(s){console.error(s.stack||s)}}}},9866:function(t,e,a){a.d(e,{T:function(){return i.TU}});var i=a(9747);const n=new i.TU.Renderer,r=n.link;n.link=(t,e,a)=>{const i=t.startsWith(`${location.protocol}//${location.hostname}`),s=r.call(n,t,e,a);return i?s:s.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')},i.TU.setOptions({renderer:n})},1631:function(t,e,a){var i=a(1033);const n={id:"app"};function r(t,e){const a=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(a)])}var s=a(3615);const o={},c=(0,s.Z)(o,[["render",r]]);var l=c,d=a(2415);const u={class:"h-100"};function g(t,e,a,n,r,s){const o=(0,i.up)("NavCategories"),c=(0,i.up)("FormGroupTagButtons"),l=(0,i.up)("TheSidebar"),d=(0,i.up)("ArticleListPageMainPanel"),g=(0,i.up)("TheMainLayout");return(0,i.wg)(),(0,i.j4)(g,{"main-panel-scroll":""},{sidebar:(0,i.w5)((()=>[(0,i.Wm)(l,null,{default:(0,i.w5)((()=>[(0,i.Wm)(o,{class:"mt-3"}),(0,i.Wm)(c,{class:"mt-3"})]),void 0,!0),_:1})])),"panel-main":(0,i.w5)((()=>[(0,i._)("div",u,[null!=s.selectedCategory?((0,i.wg)(),(0,i.j4)(d,{key:0,category:s.selectedCategory},null,8,["category"])):(0,i.kq)("",!0)])])),_:1})}var p=a(3612);const m={class:"h-100"},h={class:"d-flex"},f={class:"ml-auto"},y={class:"form-group"},v={class:"command-bar d-flex justify-content-end"},b={class:"alerts pt-3"},w={key:0,class:"alert alert-warning"},k={key:1,class:"alert alert-warning"},C={key:2,class:"alert alert-warning"},x={key:0,class:"pt-3"};function A(t,e,a,n,r,s){const o=(0,i.up)("ButtonCategorySettingPage"),c=(0,i.up)("ButtonArticleCreatePage"),l=(0,i.up)("NavArticleViewMode"),d=(0,i.up)("ArticlePanel"),u=(0,i.up)("CampactLinksPanel");return(0,i.wg)(),(0,i.iD)("div",m,[(0,i._)("div",h,[(0,i._)("h2",null,(0,i.zw)(a.category.title),1),(0,i._)("div",f,[(0,i._)("fieldset",y,[(0,i.Wm)(o,{"category-id":a.category.id},null,8,["category-id"]),(0,i.Wm)(c,{"category-id":a.category.id},null,8,["category-id"])])])]),(0,i._)("div",v,[(0,i.Wm)(l,{mode:s.mode,onChange:s.navViewModeChange},null,8,["mode","onChange"])]),(0,i._)("div",b,[s.alertCompactOnlyVisible?((0,i.wg)(),(0,i.iD)("div",w," Ë©≥Á¥∞„É¢„Éº„Éâ„ÅßÂèØËÉΩ„Å™Ë®ò‰∫ã„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Ç≥„É≥„Éë„ÇØ„Éà„É¢„Éº„Éâ„Åß„ÅÇ„Çå„Å∞Ë°®Á§∫„Åß„Åç„Åæ„Åô„ÄÇ ")):(0,i.kq)("",!0),s.alertDetailOnlyVisible?((0,i.wg)(),(0,i.iD)("div",k," „Ç≥„É≥„Éë„ÇØ„Éà„É¢„Éº„Éâ„ÅßÂèØËÉΩ„Å™Ë®ò‰∫ã„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇË©≥Á¥∞„É¢„Éº„Éâ„Åß„ÅÇ„Çå„Å∞Ë°®Á§∫„Åß„Åç„Åæ„Åô„ÄÇ ")):(0,i.kq)("",!0),s.alertNoArticle?((0,i.wg)(),(0,i.iD)("div",C," Ê§úÁ¥¢Êù°‰ª∂„Å´ÂêàËá¥„Åô„ÇãË®ò‰∫ã„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ ")):(0,i.kq)("",!0)]),s.modeDetailActive?((0,i.wg)(),(0,i.iD)("div",x,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.articles,(t=>((0,i.wg)(),(0,i.j4)(d,{key:t.id,article:t,tagPosition:a.category.tagPosition,onExpand:e=>s.articleExpand(t,e)},null,8,["article","tagPosition","onExpand"])))),128))])):(0,i.kq)("",!0),s.modeCompactActive?((0,i.wg)(),(0,i.j4)(u,{key:1,table:s.table,class:"pt-3"},null,8,["table"])):(0,i.kq)("",!0)])}const T={class:"card","body-class":"py-2"},I={class:"card-body py-2"},S={class:"d-flex align-items-center"},P={class:"mr-auto d-flex flex-column"},_={class:"title"},D={key:0},M=["href"],B={key:0,class:"tags"},E={key:0,class:"tags pr-2 h-interval"},$={class:"right-side"},Z={key:0,class:"pr-2 d-inline-block h-interval"},N=(0,i._)("i",{class:"far fa-newspaper"},null,-1),L=[N],V=(0,i._)("i",{class:"fas fa-edit"},null,-1),O=[V],R=["innerHTML"];function j(t,e,a,n,r,s){const o=(0,i.up)("ButtonExpand");return(0,i.wg)(),(0,i.iD)("div",T,[(0,i._)("div",I,[(0,i._)("div",S,[(0,i._)("div",P,[(0,i._)("div",_,[null==a.article.url?((0,i.wg)(),(0,i.iD)("span",D,(0,i.zw)(a.article.title),1)):((0,i.wg)(),(0,i.iD)("a",{key:1,href:a.article.url,target:"_blank"},(0,i.zw)(a.article.title),9,M))]),s.bottomTagsVisible?((0,i.wg)(),(0,i.iD)("div",B,[null!=a.article.tags?((0,i.wg)(),(0,i.iD)("div",E,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.article.tags,(t=>((0,i.wg)(),(0,i.iD)("span",{key:t,class:"badge badge-info"},(0,i.zw)(t),1)))),128))])):(0,i.kq)("",!0)])):(0,i.kq)("",!0)]),(0,i._)("div",$,[s.bottomTagsVisible||null==a.article.tags?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Z,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.article.tags,(t=>((0,i.wg)(),(0,i.iD)("span",{key:t,class:"badge badge-info"},(0,i.zw)(t),1)))),128))])),s.expandButtonVisible?((0,i.wg)(),(0,i.j4)(o,{key:1,expanded:s.expanded,onClick:s.expandButtonClick},null,8,["expanded","onClick"])):(0,i.kq)("",!0),(0,i._)("button",{class:"btn btn-link",onClick:e[0]||(e[0]=(...t)=>s.articleReadButtonClick&&s.articleReadButtonClick(...t))},L),(0,i._)("button",{class:"btn btn-link",onClick:e[1]||(e[1]=(...t)=>s.articleEditButtonClick&&s.articleEditButtonClick(...t))},O)])]),(0,i.wy)((0,i._)("div",{innerHTML:s.bodyHtml,class:"article-body-view"},null,8,R),[[i.F8,s.expanded]])])])}a(825);var q=a(9866);const H={key:0,class:"fas fa-arrow-circle-down"},W={key:1,class:"fas fa-arrow-circle-up"};function F(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("button",{class:"btn btn-link p-0",onClick:e[0]||(e[0]=(...t)=>s.buttonClick&&s.buttonClick(...t))},[a.expanded?((0,i.wg)(),(0,i.iD)("i",H)):((0,i.wg)(),(0,i.iD)("i",W))])}var z={name:"ButtonExpand",props:{expanded:Boolean},methods:{buttonClick(){this.$emit("click")}}};const K=(0,s.Z)(z,[["render",F]]);var Y=K,U={name:"ArticlePanel",components:{ButtonExpand:Y},props:{article:{type:Object,required:!0},tagPosition:{default:"right",type:String}},computed:{bodyHtml(){return q.T.parse(this.article.text)},expandButtonVisible(){return null!=this.article.text&&this.article.text.length>0},expanded(){return!0===this.article.expanded},bottomTagsVisible(){return"bottom"===this.tagPosition}},methods:{articleEditButtonClick(){this.$router.push({name:"ArticleEditPage",params:{id:this.article.id}})},articleReadButtonClick(){this.$router.push({name:"ArticleReadPage",params:{id:this.article.id}})},expandButtonClick(){this.$emit("expand",!this.expanded)}}};const G=(0,s.Z)(U,[["render",j]]);var J=G;const Q=(0,i._)("i",{class:"fas fa-plus"},null,-1),X=[Q];function tt(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("button",{class:"btn btn-link",onClick:e[0]||(e[0]=(...t)=>s.buttonClick&&s.buttonClick(...t))},X)}var et={name:"ButtonArticleCreatePage",props:{categoryId:Number},methods:{buttonClick(){const{categoryId:t}=this;this.$router.push({name:"ArticleCreatePage",params:{categoryId:t}})}}};const at=(0,s.Z)(et,[["render",tt]]);var it=at;const nt=(0,i._)("i",{class:"fas fa-cog"},null,-1),rt=[nt];function st(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("button",{class:"btn btn-link",onClick:e[0]||(e[0]=(...t)=>s.buttonClick&&s.buttonClick(...t))},rt)}var ot={name:"ButtonCategorySettingPage",props:{categoryId:Number},methods:{buttonClick(){const{categoryId:t}=this;this.$router.push({name:"CategorySettingPage",params:{categoryId:t}})}}};const ct=(0,s.Z)(ot,[["render",st]]);var lt=ct;const dt=["href"];function ut(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("div",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.table,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.text,class:"h-interval"},[(0,i._)("h3",null,(0,i.zw)(t.text),1),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.articles,(t=>((0,i.wg)(),(0,i.iD)("a",{key:t.id,href:t.url,target:"_blank"},(0,i.zw)(t.title),9,dt)))),128))])))),128))])}var gt={name:"CampactLinksPanel",props:{table:Array}};const pt=(0,s.Z)(gt,[["render",ut]]);var mt=pt;const ht={class:"nav nav-pills small"},ft={class:"nav-item"},yt={class:"nav-item"};function vt(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("ul",ht,[(0,i._)("li",ft,[(0,i._)("a",{class:(0,i.C_)(s.compactNavLinkClass),href:"#",target:"_self",onClick:e[0]||(e[0]=(...t)=>s.modeCompactNavClick&&s.modeCompactNavClick(...t))}," „Ç≥„É≥„Éë„ÇØ„Éà ",2)]),(0,i._)("li",yt,[(0,i._)("a",{class:(0,i.C_)(s.detailNavLinkClass),href:"#",target:"_self",onClick:e[1]||(e[1]=(...t)=>s.modeDetailNavClick&&s.modeDetailNavClick(...t))}," Ë©≥Á¥∞ ",2)])])}var bt={name:"NavArticleViewMode",props:{mode:String},computed:{compactNavLinkClass(){return{active:"compact"===this.mode,"nav-link":!0}},detailNavLinkClass(){return{active:"detail"===this.mode,"nav-link":!0}}},methods:{modeCompactNavClick(){this.$emit("change","compact")},modeDetailNavClick(){this.$emit("change","detail")}}};const wt=(0,s.Z)(bt,[["render",vt]]);var kt=wt;class Ct{create(t,e){const a=this.getArticles(t,e),i=this.getTags(a);return this.getTable(a,i)}getArticles(t,e){return t.filter((t=>null!=t.url)).filter((t=>this.isTargetArticle(t,e)))}isTargetArticle(t,e){return null==e||e.length<=0||null!=t.tags&&e.every((e=>t.tags.includes(e)))}getTags(t){const e=t.some((t=>null==t.tags||t.tags.length<=0)),a=e?[{text:"Ôºà„Çø„Ç∞„Å™„ÅóÔºâ",value:null}]:[],i=t.map((t=>t.tags)).reduce(((t,e)=>(e.forEach((e=>{!1===t.includes(e)&&t.push(e)})),t)),[]).map((t=>({text:t,value:t})));return[...a,...i]}getTable(t,e){return e.map((e=>{const a=t.filter((t=>null==e.value?null==t.tags||t.tags.length<=0:null!=t.tags&&t.tags.includes(e.value)));return{...e,articles:a}}))}}const xt=new Ct;var At={name:"ArticleListPageMainPanel",components:{ArticlePanel:J,ButtonArticleCreatePage:it,ButtonCategorySettingPage:lt,CampactLinksPanel:mt,NavArticleViewMode:kt},props:{category:{type:Object,required:!0}},computed:{alertCompactOnlyVisible(){return this.modeDetailActive&&this.articles.length<=0&&this.table.length>0},alertDetailOnlyVisible(){return this.modeCompactActive&&this.articles.length>0&&this.table.length<=0},alertNoArticle(){return this.articles.length<=0&&this.table.length<=0},articles(){const{articles:t,selectedTagTexts:e}=this.$store.state;return t.filter((t=>xt.isTargetArticle(t,e)))},mode(){return"detail"===this.category.articlesViewMode?"detail":"compact"},modeCompactActive(){return"compact"===this.mode},modeDetailActive(){return"detail"===this.mode},table(){const{articles:t,selectedTagTexts:e}=this.$store.state;return xt.create(t,e)}},methods:{articleExpand(t,e){const{id:a}=t;this.$store.dispatch("setArticleExpanded",{id:a,expanded:e})},navViewModeChange(t){const e=this.category.id;this.$store.dispatch("setArticlesViewModeToCategory",{categoryId:e,articlesViewMode:t})}}};const Tt=(0,s.Z)(At,[["render",A]]);var It=Tt;const St={class:"nav flex-column nav-category mt-3"},Pt=["onClick"];function _t(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("ul",St,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.categories,(t=>((0,i.wg)(),(0,i.iD)("li",{class:"nav-item",key:t.id,onClick:e=>s.categorySelect(t)},[(0,i._)("a",{class:(0,i.C_)(t.anchorClass),href:"#",target:"_self"},(0,i.zw)(t.title),3)],8,Pt)))),128))])}var Dt={name:"NavCategories",computed:{categories(){return this.$store.state.categories.map((t=>{const{id:e,title:a}=t,i=e===this.$store.state.categoryId,n={active:i,"nav-link":!0};return{anchorClass:n,id:e,title:a}}))}},methods:{async categorySelect(t){null!=t&&(this.$store.commit("setCategoryId",t.id),await this.$store.dispatch("loadArticles",t.id))}}};const Mt=(0,s.Z)(Dt,[["render",_t]]);var Bt=Mt;const Et={class:"form-group"},$t=["onClick"];function Zt(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("fieldset",Et,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.tagButtons,(t=>((0,i.wg)(),(0,i.iD)("button",{key:t.text,class:(0,i.C_)(t.className),onClick:e=>s.tagButtonClick(t)},(0,i.zw)(t.text),11,$t)))),128))])}var Nt={name:"FormGroupTagButtons",computed:{tagButtons(){return this.allTags.map((t=>{const{selected:e,text:a}=t,i=e?"btn btn-sm btn-info":"btn btn-sm btn-outline-info";return{selected:e,text:a,className:i}}))},...(0,p.Se)(["allTags"])},methods:{tagButtonClick(t){const{text:e,selected:a}=t;this.$store.commit("selectTagText",{text:e,selected:!a})}}};const Lt=(0,s.Z)(Nt,[["render",Zt]]);var Vt=Lt,Ot={name:"ArticlesListPage",components:{ArticleListPageMainPanel:It,FormGroupTagButtons:Vt,NavCategories:Bt},computed:{...(0,p.rn)(["categories","categoryId"]),selectedCategory(){return this.categories.filter((t=>t.id===this.categoryId))[0]}},async mounted(){this.$store.dispatch("loadCategories")}};const Rt=(0,s.Z)(Ot,[["render",g]]);var jt=Rt;const qt=[{path:"/",name:"ArticlesListPage",component:jt},{path:"/categories/:categoryId/articles/create",name:"ArticleCreatePage",component:()=>a.e(525).then(a.bind(a,8632))},{path:"/articles/:id/edit",name:"ArticleEditPage",component:()=>a.e(525).then(a.bind(a,8734))},{path:"/articles/:id/read",name:"ArticleReadPage",component:()=>a.e(525).then(a.bind(a,7004))},{path:"/categories",name:"CategoryPage",component:()=>a.e(267).then(a.bind(a,9124))},{path:"/categories/:id/import",name:"CategoryImportPage",component:()=>a.e(267).then(a.bind(a,1083))},{path:"/categories/:categoryId/setting",name:"CategorySettingPage",component:()=>a.e(267).then(a.bind(a,8027))},{path:"/settings",name:"SettingPage",component:()=>a.e(571).then(a.bind(a,3857))}],Ht=(0,d.p7)({history:(0,d.r5)(),routes:qt});var Wt=Ht;class Ft{fromArticles(t){return t.map((t=>{const e=null==t.text?null:t.text.match("^https?://[^ \r\n\t]+"),a=null==e?null:e[0];return{expanded:!1,url:a,...t}}))}}var zt=a(7370),Kt=a(5191),Yt=a(4793),Ut=a(4559);class Gt{constructor(t){this.categoryRepository=t}async setSettings(t,{articlesViewMode:e,tagPosition:a,tagSelectionMode:i}){const n=await this.categoryRepository.get(t);if(null==n)throw console.error("Specified categoryId not found. categoryId:",t),new Error("Specified categoryId not found. categoryId: "+t);const r={...n,categoryId:t,articlesViewMode:e??n.articlesViewMode,tagPosition:a??n.tagPosition,tagSelectionMode:i??n.tagSelectionMode};try{await this.categoryRepository.put(r),console.log("‰øùÂ≠ò„Åó„Åæ„Åó„Åü(service):",r)}catch(s){console.error("„Ç´„ÉÜ„Ç¥„É™„Éº„Çí‰øùÂ≠ò„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ",s.stack||s)}}}var Jt={namespaced:!0,state:()=>({article:null,articleId:null}),mutations:{setArticle(t,e){const a=null==e||null==e.text?null:q.T.parse(e.text);t.article={html:a,...e}},setArticleId(t,e){t.articleId=e}},actions:{async loadSetting({commit:t,rootGetters:e}){const{articleService:a,settingService:i}=e.getDependances(),{articleId:n}=await i.getSidebarSetting();if(null==n)return t("setArticleId",null),void t("setArticle",null);const r=await a.get({articleId:n}),s=r[0];t("setArticleId",n),t("setArticle",s)},async setArticleId({commit:t,rootGetters:e},a){const{settingService:i}=e.getDependances();await i.setSidebarArticleId(a),t("setArticleId",a)}}};const Qt=new Ft,Xt=new Kt.Z,te=new zt.Z(Xt),ee=new Ut.Z(Xt),ae=new Gt(ee),ie=new Yt.Z(te,ee),ne={articlesDatabase:Xt,articleRepository:te,articleService:ie,settingService:null};i.ZP.use(p.ZP);var re=new p.ZP.Store({state:{articles:[],categoryId:null,categories:[],selectedTagTexts:[]},getters:{allTags(t){const e=t.articles.map((t=>t.tags??[])).reduce(((t,e)=>(e.filter((e=>!1===t.includes(e))).forEach((e=>t.push(e))),t)),[]);return e.map((e=>{const a=t.selectedTagTexts.includes(e);return{selected:a,text:e,value:e}}))},getDependances(){return()=>({...ne})}},mutations:{selectTagText(t,{text:e,selected:a}){const i=t.categories.filter((e=>e.id===t.categoryId)),n=i[0]?.tagSelectionMode??"single",r=t.selectedTagTexts.includes(e);"single"!==n?r?!1===a&&(t.selectedTagTexts=t.selectedTagTexts.filter((t=>t!==e))):a&&t.selectedTagTexts.push(e):t.selectedTagTexts=r?[]:[e]},setArticleExpand(t,{id:e,expanded:a}){t.articles.filter((t=>t.id===e)).forEach((t=>{t.expanded=a}))},setArticles(t,e){t.articles=e},setCategories(t,{autoSelect:e,categories:a}){t.categories=a,a.length>0&&null==t.categoryId&&(t.categoryId=a[0].id)},setCategoryId(t,e){t.categoryId=e,t.selectedTagTexts=[]},setCategorySettings(t,{categoryId:e,articlesViewMode:a,tagPosition:i,tagSelectionMode:n}){t.categories.filter((t=>t.id===e)).forEach((t=>{t.articlesViewMode=a??t.articlesViewMode,t.tagPosition=i??t.tagPosition,t.tagSelectionMode=n??t.tagSelectionMode}))}},actions:{async exportArticles(t,{categoryId:e}){const a=await ie.get({categoryId:e});te.export(a)},async loadArticles(t,e){const a=await ie.get({categoryId:e}),i=Qt.fromArticles(a);t.commit("setArticles",i),t.commit("setCategoryId",e)},async loadCategories({commit:t,dispatch:e,state:a}){const i=await ee.getAll();t("setCategories",{autoSelect:!0,categories:i}),null!=a.categoryId&&await e("loadArticles",a.categoryId)},setArticleExpanded(t,{id:e,expanded:a}){t.commit("setArticleExpand",{id:e,expanded:a}),ie.setExpanding(e,a)},async setArticlesViewModeToCategory(t,{categoryId:e,articlesViewMode:a}){console.log("store...",{categoryId:e,articlesViewMode:a}),t.commit("setCategorySettings",{categoryId:e,articlesViewMode:a}),await ae.setSettings(e,{articlesViewMode:a})},async setCategorySettings(t,{categoryId:e,tagPosition:a,tagSelectionMode:i}){t.commit("setCategorySettings",{categoryId:e,tagPosition:a,tagSelectionMode:i}),await ae.setSettings(e,{tagPosition:a,tagSelectionMode:i})}},modules:{sidebar:Jt}});const se={class:"alert alert-warning"};function oe(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("div",se," „Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ ")}var ce={name:"NotFoundAlert"};const le=(0,s.Z)(ce,[["render",oe]]);var de=le;const ue={class:"d-flex flex-column h-100"},ge={class:"flex-grow-1 h-0"},pe={class:"h-100"};function me(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("div",ue,[(0,i.WI)(t.$slots,"header",{},void 0,!0),(0,i._)("div",ge,[(0,i._)("div",pe,[(0,i.WI)(t.$slots,"default",{},void 0,!0)])]),(0,i.WI)(t.$slots,"footer",{},void 0,!0)])}var he={};const fe=(0,s.Z)(he,[["render",me],["__scopeId","data-v-bc4d3014"]]);var ye=fe;const ve={class:"container-fluid h-100 container-main"},be={class:"row h-100"},we={key:0,class:"col-sm-4 col-md-3 col-12 h-100-sm sidebar pr-0"},ke={class:"h-100 pr-3"};function Ce(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("div",ve,[(0,i._)("div",be,[a.noSidebar?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",we,[(0,i._)("div",ke,[(0,i.WI)(t.$slots,"sidebar")])])),(0,i._)("div",{cols:"12",class:(0,i.C_)(s.mainPanelClass)},[(0,i.WI)(t.$slots,"panel-main")],2)])])}var xe={props:{noSidebar:Boolean,mainPanelScroll:Boolean},computed:{mainPanelClass(){return{"col-sm-8":!this.noSidebar,"col-sm-12":this.noSidebar,"col-md-9":!this.noSidebar,"col-md-12":this.noSidebar,"h-100-sm":!0,"panel-main":!0,"overflow-auto":this.mainPanelScroll}}}};const Ae=(0,s.Z)(xe,[["render",Ce]]);var Te=Ae;const Ie=t=>((0,i.dD)("data-v-bb037de6"),t=t(),(0,i.Cn)(),t),Se={class:"d-flex flex-column h-100"},Pe=Ie((()=>(0,i._)("h1",{class:"h2"},[(0,i._)("span",null,"üè†"),(0,i._)("span",{class:"site-title-animals"},"üêïü¶òüê¨üêìüïäü¶¢")],-1))),_e=Ie((()=>(0,i._)("div",{class:"mt-auto"},null,-1))),De={key:0},Me=["innerHTML"],Be={key:1,class:"form-group"},Ee=Ie((()=>(0,i._)("i",{class:"far fa-newspaper"},null,-1))),$e=Ie((()=>(0,i._)("span",{class:"ml-2"},"Ë®ò‰∫ã",-1))),Ze=[Ee,$e],Ne={key:2,class:"form-group"},Le=Ie((()=>(0,i._)("i",{class:"far fa-folder-open"},null,-1))),Ve=Ie((()=>(0,i._)("span",{class:"ml-2"},"„Ç´„ÉÜ„Ç¥„É™„Éº",-1))),Oe=[Le,Ve],Re={key:3,class:"form-group"},je=Ie((()=>(0,i._)("i",{class:"fas fa-cog"},null,-1))),qe=Ie((()=>(0,i._)("span",{class:"ml-2"},"Ë®≠ÂÆö",-1))),He=[je,qe];function We(t,e,a,n,r,s){return(0,i.wg)(),(0,i.iD)("div",Se,[Pe,(0,i.WI)(t.$slots,"default",{},void 0,!0),_e,null!=s.sidebarArticle?((0,i.wg)(),(0,i.iD)("div",De,[(0,i._)("div",{innerHTML:s.sidebarArticle.html},null,8,Me)])):(0,i.kq)("",!0),"ArticlesListPage"!=t.$route.name?((0,i.wg)(),(0,i.iD)("fieldset",Be,[(0,i._)("button",{class:"btn btn-link",onClick:e[0]||(e[0]=(...t)=>s.articleListButtonClick&&s.articleListButtonClick(...t))},Ze)])):(0,i.kq)("",!0),"CategoryPage"!=t.$route.name?((0,i.wg)(),(0,i.iD)("fieldset",Ne,[(0,i._)("button",{class:"btn btn-link",onClick:e[1]||(e[1]=(...t)=>s.categoryButtonClick&&s.categoryButtonClick(...t))},Oe)])):(0,i.kq)("",!0),"SettingPage"!=t.$route.name?((0,i.wg)(),(0,i.iD)("fieldset",Re,[(0,i._)("button",{class:"btn btn-link",onClick:e[2]||(e[2]=(...t)=>s.settingButtonClick&&s.settingButtonClick(...t))},He)])):(0,i.kq)("",!0)])}var Fe={name:"TheSidebar",computed:{sidebarArticle(){return this.$store.state.sidebar.article}},async mounted(){null==this.$store.state.sidebar.articleId&&await this.$store.dispatch("sidebar/loadSetting")},methods:{articleListButtonClick(){this.$router.push({name:"ArticlesListPage"})},categoryButtonClick(){this.$router.push({name:"CategoryPage"})},settingButtonClick(){this.$router.push({name:"SettingPage"})}}};const ze=(0,s.Z)(Fe,[["render",We],["__scopeId","data-v-bb037de6"]]);var Ke=ze;class Ye{constructor(t){this.database=t.instance}async get(t){return await this.database.settings.get(t)}async put(t){try{return await this.database.settings.put(t)}catch(e){console.error(e.stack??e)}}}class Ue{constructor(t){this.settingRepository=t}async getSidebarSetting(){const{articleId:t}=await this.settingRepository.get("sidebar")??{};return{name:"sidebar",articleId:t}}async setSidebarArticleId(t){const e=await this.getSidebarSetting();e.articleId=t,console.log("service sidebar:",e),await this.settingRepository.put(e)}}i.ZP.component("NotFoundAlert",de),i.ZP.component("FullHeight",ye),i.ZP.component("TheMainLayout",Te),i.ZP.component("TheSidebar",Ke),i.ZP.config.productionTip=!1;const Ge=new Ye(ne.articlesDatabase),Je=new Ue(Ge);ne.settingService=Je,i.ZP.createApp({render:t=>t(l)}).use(Wt).use(re).mount("#app")},4793:function(t,e,a){a.d(e,{Z:function(){return i}});class i{constructor(t,e){this.articleRepository=t,this.categoryRepository=e}async get({categoryId:t,articleId:e}){try{const a=await this.articleRepository.getArticles({categoryId:t,articleId:e}),i=a.map((t=>t.id)),n=await this.articleRepository.getArticleTags(i);return a.map((t=>this.getResult(t,n)))}catch(a){console.error("Ë®ò‰∫ãË™≠„ÅøËæº„ÇÅ„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ",a)}}async set({id:t,categoryId:e,expanded:a,title:i,text:n,tags:r}){const s=await this.categoryRepository.get(e);if(null==s)throw console.error("Specified categoryId not found. categoryId:",e),new Error("Specified categoryId not found. categoryId: "+e);try{const s=await this.articleRepository.setArticle({id:t,categoryId:e,expanded:a,title:i,text:n});console.log("Inserted. articleId:",s);const o=await this.articleRepository.getArticleTags([s]);if(!this.areEqualTagsToArticleTags(r,o)){const t=o.map((t=>t.id));await this.articleRepository.deleteTagsFromArticle(t),await this.articleRepository.addTagsToArticle(s,r)}return s}catch(o){console.error("Ë®ò‰∫ã„Çí‰øùÂ≠ò„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ",o.stack||o)}}async setExpanding(t,e){try{const a=await this.articleRepository.getArticles({articleId:t});if(a.length<=0)throw new Error("Specified articleId not found. articleId: "+t);a[0].expanded=e,this.articleRepository.setArticle(a[0])}catch(a){console.error("Ë®ò‰∫ã„Çí‰øùÂ≠ò„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ",a.stack||a)}}getResult(t,e){const a=e.filter((e=>e.articleId===t.id)).map((t=>t.tagText)),i=Array.from(new Set(a).values());return{...t,tags:i}}areEqualTagsToArticleTags(t,e){if(t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==e[a].tagText)return!1;return!0}}}},e={};function a(i){var n=e[i];if(void 0!==n)return n.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,a),r.exports}a.m=t,function(){var t=[];a.O=function(e,i,n,r){if(!i){var s=1/0;for(d=0;d<t.length;d++){i=t[d][0],n=t[d][1],r=t[d][2];for(var o=!0,c=0;c<i.length;c++)(!1&r||s>=r)&&Object.keys(a.O).every((function(t){return a.O[t](i[c])}))?i.splice(c--,1):(o=!1,r<s&&(s=r));if(o){t.splice(d--,1);var l=n();void 0!==l&&(e=l)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[i,n,r]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(e,i){return a.f[i](t,e),e}),[]))}}(),function(){a.u=function(t){return"js/"+{267:"categories",525:"articles",571:"settings"}[t]+"."+{267:"3bfcc1b5",525:"863bb984",571:"c7654a76"}[t]+".js"}}(),function(){a.miniCssF=function(t){return"css/articles.c0bbcc31.css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="portal:";a.l=function(i,n,r,s){if(t[i])t[i].push(n);else{var o,c;if(void 0!==r)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==e+r){o=u;break}}o||(c=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",e+r),o.src=i),t[i]=[n];var g=function(e,a){o.onerror=o.onload=null,clearTimeout(p);var n=t[i];if(delete t[i],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach((function(t){return t(a)})),e)return e(a)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=g.bind(null,o.onerror),o.onload=g.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.p=""}(),function(){if("undefined"!==typeof document){var t=function(t,e,a,i,n){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css";var s=function(a){if(r.onerror=r.onload=null,"load"===a.type)i();else{var s=a&&("load"===a.type?"missing":a.type),o=a&&a.target&&a.target.href||e,c=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=s,c.request=o,r.parentNode.removeChild(r),n(c)}};return r.onerror=r.onload=s,r.href=e,a?a.parentNode.insertBefore(r,a.nextSibling):document.head.appendChild(r),r},e=function(t,e){for(var a=document.getElementsByTagName("link"),i=0;i<a.length;i++){var n=a[i],r=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(r===t||r===e))return n}var s=document.getElementsByTagName("style");for(i=0;i<s.length;i++){n=s[i],r=n.getAttribute("data-href");if(r===t||r===e)return n}},i=function(i){return new Promise((function(n,r){var s=a.miniCssF(i),o=a.p+s;if(e(s,o))return n();t(i,o,null,n,r)}))},n={143:0};a.f.miniCss=function(t,e){var a={525:1};n[t]?e.push(n[t]):0!==n[t]&&a[t]&&e.push(n[t]=i(t).then((function(){n[t]=0}),(function(e){throw delete n[t],e})))}}}(),function(){var t={143:0};a.f.j=function(e,i){var n=a.o(t,e)?t[e]:void 0;if(0!==n)if(n)i.push(n[2]);else{var r=new Promise((function(a,i){n=t[e]=[a,i]}));i.push(n[2]=r);var s=a.p+a.u(e),o=new Error,c=function(i){if(a.o(t,e)&&(n=t[e],0!==n&&(t[e]=void 0),n)){var r=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;o.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",o.name="ChunkLoadError",o.type=r,o.request=s,n[1](o)}};a.l(s,c,"chunk-"+e,e)}},a.O.j=function(e){return 0===t[e]};var e=function(e,i){var n,r,s=i[0],o=i[1],c=i[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(n in o)a.o(o,n)&&(a.m[n]=o[n]);if(c)var d=c(a)}for(e&&e(i);l<s.length;l++)r=s[l],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(d)},i=self["webpackChunkportal"]=self["webpackChunkportal"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=a.O(void 0,[998],(function(){return a(1631)}));i=a.O(i)})();
//# sourceMappingURL=app.dd39b278.js.map