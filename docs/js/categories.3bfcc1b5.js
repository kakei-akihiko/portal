"use strict";(self["webpackChunkportal"]=self["webpackChunkportal"]||[]).push([[267],{1083:function(t,e,a){a.r(e),a.d(e,{default:function(){return P}});var o=a(1033);const l={class:"h-100"},s={key:1,class:"h-100"},i={class:"form-group"},n={class:"custom-file b-form-file"},c={class:"d-flex"},r={class:"form-group ml-auto"},d=["disabled"],u={class:"list-group"},g={key:0,class:"badge bdge-info ml-auto"};function m(t,e,a,m,p,y){const h=(0,o.up)("TheSidebar"),w=(0,o.up)("NotFoundAlert"),f=(0,o.up)("TheMainLayout");return(0,o.wg)(),(0,o.j4)(f,{"main-panel-scroll":""},{sidebar:(0,o.w5)((()=>[(0,o.Wm)(h)])),"panel-main":(0,o.w5)((()=>[(0,o._)("div",l,[null==p.category?((0,o.wg)(),(0,o.j4)(w,{key:0})):((0,o.wg)(),(0,o.iD)("div",s,[(0,o._)("h2",null,"記事を"+(0,o.zw)(p.category.title)+"にインポート",1),(0,o._)("fieldset",i,[(0,o._)("div",n,[(0,o._)("input",{type:"file",accept:"application/json",onChange:e[0]||(e[0]=(...t)=>y.fileSelect&&y.fileSelect(...t))},null,32)])]),(0,o._)("div",c,[(0,o._)("fieldset",r,[(0,o.wy)((0,o._)("button",{disabled:y.importButton.disabled,class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>y.importButtonClick&&y.importButtonClick(...t))}," 選択をインポート ",8,d),[[o.F8,y.importButton.visible]])])]),(0,o._)("div",u,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(p.articles,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"list-group-item d-flex",key:t.id},[(0,o._)("div",null,(0,o.zw)(t.title),1),t.completed?((0,o.wg)(),(0,o.iD)("span",g," 済 ")):(0,o.kq)("",!0)])))),128))])]))])])),_:1})}class p{async parse(t){try{const e=await this.readFileAsText(t),a=JSON.parse(e).articles;return{succeeded:!0,articles:a}}catch(e){const t="ファイルの読み込みに失敗しました。";return console.log(t,e),{succeeded:!1,exception:e,message:t}}}async readFileAsText(t){return await new Promise((e=>{const a=new FileReader;a.onload=()=>e(a.result),a.readAsText(t)}))}}var y=a(7370),h=a(4793),w=a(5191),f=a(4559);const _=new w.Z,b=new f.Z(_),C=new p,v=new y.Z(_),S=new h.Z(v,b);var k={name:"CategoryImportPage",data(){return{articles:[],category:null,categoryId:null,file:null}},computed:{importButton(){const t=null==this.articles?0:this.articles.length,e=null==this.articles?0:this.articles.filter((t=>!t.completed)).length,a=e<=0||null==this.file,o=t>0&&null!=this.file;return{disabled:a,visible:o}}},watch:{$route(t){this.categoryId=parseInt(t.params.id),this.loadCategory()}},mounted(){this.categoryId=parseInt(this.$route.params.id),this.loadCategory()},methods:{async fileSelect(t){console.log(t.target.files[0]);const e=t.target.files[0];if(this.file=e,null==e)return;const{succeeded:a,articles:o}=await C.parse(e);a&&(this.articles=o.map((t=>({...t,completed:!1}))))},async importButtonClick(){this.articles.filter((t=>!t.computed)).forEach((async t=>{const{title:e,text:a,tags:o}=t,l=this.categoryId;await S.set({categoryId:l,title:e,text:a,tags:o}),t.completed=!0}))},async loadCategory(){this.category=await b.get(this.categoryId)}}},I=a(3615);const N=(0,I.Z)(k,[["render",m]]);var P=N},9124:function(t,e,a){a.r(e),a.d(e,{default:function(){return x}});var o=a(1033);const l={class:"h-100"},s=(0,o._)("h2",null,"カテゴリー",-1),i={class:"section-new-card"},n=(0,o._)("h3",null,"新規作成",-1),c={class:"card card-new-category"},r={class:"card-body"},d={class:"form-group",label:"名称"},u=(0,o._)("legend",{tabindex:"-1",class:"col-form-label pt-0"}," 名称 ",-1),g={class:"form-group mb-0"},m=["disabled"],p={class:"section-list"},y=(0,o._)("h3",null,"一覧",-1),h={class:"card-body d-flex"},w={class:"ml-auto h-interval"},f=["onClick"],_=(0,o._)("i",{class:"fas fa-download"},null,-1);function b(t,e,a,b,C,v){const S=(0,o.up)("TheSidebar"),k=(0,o.up)("router-link"),I=(0,o.up)("TheMainLayout");return(0,o.wg)(),(0,o.j4)(I,{"main-panel-scroll":""},{sidebar:(0,o.w5)((()=>[(0,o.Wm)(S)])),"panel-main":(0,o.w5)((()=>[(0,o._)("div",l,[s,(0,o._)("section",i,[n,(0,o._)("div",c,[(0,o._)("div",r,[(0,o._)("fieldset",d,[u,(0,o.wy)((0,o._)("input",{class:"form-control",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>v.cardNewCategoryName=t)},null,512),[[o.nr,v.cardNewCategoryName]])]),(0,o._)("fieldset",g,[(0,o._)("button",{disabled:v.cardNewCategoryCreateButtonDisabled,class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>v.createCategoryButtonClick&&v.createCategoryButtonClick(...t))}," 作成 ",8,m)])])])]),(0,o._)("section",p,[y,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.$store.state.categories,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"card",key:t.id},[(0,o._)("div",h,[(0,o._)("div",null,(0,o.zw)(t.title),1),(0,o._)("div",w,[(0,o.Wm)(k,{to:{name:"CategoryImportPage",params:{id:t.id}}},{default:(0,o.w5)((()=>[(0,o.Uk)(" インポート ")]),void 0,!0),_:2},1032,["to"]),(0,o._)("button",{class:"btn btn-info",onClick:e=>v.exportButtonClick(t)},[_,(0,o.Uk)(" エクスポート ")],8,f)])])])))),128))])])])),_:1})}var C=a(5191),v=a(4559);const S=new C.Z,k=new v.Z(S);var I={name:"CategoryPage",computed:{cardNewCategoryCreateButtonDisabled(){const{created:t,name:e}=this.cardNewCategory;return t||null==e||e.length<=0},cardNewCategoryName:{get(){return this.cardNewCategory.name},set(t){this.cardNewCategory.name=t,this.cardNewCategory.created=!1}}},data(){return{cardNewCategory:{created:!1,name:""}}},mounted(){this.$store.dispatch("loadCategories")},methods:{async createCategoryButtonClick(){this.cardNewCategory.created=!0;const t=this.cardNewCategory.name,e="single",a=await k.put({title:t,tagSelectionMode:e});console.log("Category created. categoryId:",a),this.$store.dispatch("loadCategories")},async exportButtonClick(t){const e=t.id;this.$store.dispatch("exportArticles",{categoryId:e})}}},N=a(3615);const P=(0,N.Z)(I,[["render",b]]);var x=P},8027:function(t,e,a){a.r(e),a.d(e,{default:function(){return Z}});var o=a(1033);const l={slot:"panel-main",class:"h-100"},s={key:1,class:"h-100"},i={class:"form-group"},n={class:"form-row"},c=(0,o._)("legend",{tabindex:"-1",class:"col-4 col-form-label pt-0"}," タグの選択 ",-1),r={class:"col"},d={class:"custom-control custom-control-inline custom-radio"},u=(0,o._)("label",{class:"custom-control-label",for:"tagsSelection-single"},[(0,o._)("span",null,"最大1個")],-1),g={class:"custom-control custom-control-inline custom-radio"},m=(0,o._)("label",{class:"custom-control-label",for:"tagsSelection-multiple"},[(0,o._)("span",null,"複数")],-1),p={class:"form-group"},y={class:"form-row"},h=(0,o._)("legend",{tabindex:"-1",class:"col-4 col-form-label pt-0"}," タグの表示位置 ",-1),w={class:"col"},f={class:"custom-control custom-control-inline custom-radio"},_=(0,o._)("label",{class:"custom-control-label",for:"tagsPosition-right"},[(0,o._)("span",null,"タイトルの右")],-1),b={class:"custom-control custom-control-inline custom-radio"},C=(0,o._)("label",{class:"custom-control-label",for:"tagsPosition-bottom"},[(0,o._)("span",null,"タイトルの下")],-1);function v(t,e,a,v,S,k){const I=(0,o.up)("TheSidebar"),N=(0,o.up)("NotFoundAlert"),P=(0,o.up)("TheMainLayout");return(0,o.wg)(),(0,o.j4)(P,{"main-panel-scroll":""},{sidebar:(0,o.w5)((()=>[(0,o.Wm)(I)])),"panel-main":(0,o.w5)((()=>[(0,o._)("div",l,[null==S.category?((0,o.wg)(),(0,o.j4)(N,{key:0})):((0,o.wg)(),(0,o.iD)("div",s,[(0,o._)("h2",null,(0,o.zw)(S.category.title)+"の設定",1),(0,o._)("form",null,[(0,o._)("fieldset",i,[(0,o._)("div",n,[c,(0,o._)("div",r,[(0,o._)("div",d,[(0,o.wy)((0,o._)("input",{class:"custom-control-input",type:"radio",name:"tagsSelection",value:"single","onUpdate:modelValue":e[0]||(e[0]=t=>k.tagSelectionSelected=t),id:"tagsSelection-single"},null,512),[[o.G2,k.tagSelectionSelected]]),u]),(0,o._)("div",g,[(0,o.wy)((0,o._)("input",{class:"custom-control-input",type:"radio",name:"tagsSelection",value:"multiple","onUpdate:modelValue":e[1]||(e[1]=t=>k.tagSelectionSelected=t),id:"tagsSelection-multiple"},null,512),[[o.G2,k.tagSelectionSelected]]),m])])])]),(0,o._)("fieldset",p,[(0,o._)("div",y,[h,(0,o._)("div",w,[(0,o._)("div",f,[(0,o.wy)((0,o._)("input",{class:"custom-control-input",type:"radio",name:"tagsPosition",value:"right","onUpdate:modelValue":e[2]||(e[2]=t=>k.tagPositionSelected=t),id:"tagsPosition-right"},null,512),[[o.G2,k.tagPositionSelected]]),_]),(0,o._)("div",b,[(0,o.wy)((0,o._)("input",{class:"custom-control-input",type:"radio",name:"tagsPosition",value:"bottom","onUpdate:modelValue":e[3]||(e[3]=t=>k.tagPositionSelected=t),id:"tagsPosition-bottom"},null,512),[[o.G2,k.tagPositionSelected]]),C])])])])])]))])])),_:1})}var S=a(5191),k=a(4559);const I=new S.Z,N=new k.Z(I);var P={name:"CategorySettingPage",data(){return{category:null,categoryId:null}},computed:{tagPositionSelected:{get(){return this.category?.tagPosition??"right"},async set(t){const{categoryId:e}=this;await this.$store.dispatch("setCategorySettings",{categoryId:e,tagPosition:t}),await this.loadCategory()}},tagSelectionSelected:{get(){return this.category?.tagSelectionMode??"single"},async set(t){console.log("tagSelectionSelected set",t);const{categoryId:e}=this;await this.$store.dispatch("setCategorySettings",{categoryId:e,tagSelectionMode:t}),await this.loadCategory()}}},watch:{$route(t){this.categoryId=parseInt(t.params.categoryId),this.loadCategory()}},mounted(){this.categoryId=parseInt(this.$route.params.categoryId),this.loadCategory()},methods:{async loadCategory(){this.category=await N.get(this.categoryId)}}},x=a(3615);const B=(0,x.Z)(P,[["render",v]]);var Z=B}}]);
//# sourceMappingURL=categories.3bfcc1b5.js.map