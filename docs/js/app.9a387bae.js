(function(){"use strict";var t={2974:function(t,e,a){a.d(e,{Z:function(){return l}});var n=a(9199),r=a.n(n),i=a(9821),o=a.n(i);r().extend(o());class l{constructor(t){this.database=t.instance}async addTagsToArticle(t,e){const a=e.map((e=>({articleId:t,tagText:e})));await this.database.articleTags.bulkPut(a)}async deleteTagsFromArticle(t){await this.database.articleTags.bulkDelete(t)}export(t){const e=JSON.stringify({articles:t},null,2),a=new Blob([e],{type:"application/json"}),n=document.createElement("a");n.href=URL.createObjectURL(a),n.target="_blank",n.download="Articles.json",document.body.appendChild(n),n.click(),document.body.removeChild(n)}async getArticles({categoryId:t,articleId:e}){return await this.database.articles.filter((a=>(null==t||a.categoryId===t)&&(null==e||a.id===e))).toArray()}async getArticleTags(t){return await this.database.articleTags.filter((e=>t.includes(e.articleId))).toArray()}async getTagTexts(t){return await this.database.articleTags.filter((e=>e.articleId===t)).toArray()}async setArticle({id:t,categoryId:e,expanded:a,title:n,text:i}){const o=r().utc().format();return await this.database.articles.put({id:t,categoryId:e,expanded:a,title:n,text:i,updatedOn:o})}}},4334:function(t,e,a){a.d(e,{Z:function(){return r}});var n=a(2031);class r{constructor(){this.instance=new n.ZP("articlesDatabase"),this.instance.version(2).stores({articles:"++id, categoryId, title, text, createdOn, updatedOn",articleTags:"++id, articleId, tagText",categories:"++id, title",settings:"name"}),this.instance.version(1).stores({articles:"++id, categoryId, title, text, createdOn, updatedOn",articleTags:"++id, articleId, tagText",categories:"++id, title"})}delete(){n.ZP["delete"]("articlesDatabase")}}},9568:function(t,e,a){a.d(e,{Z:function(){return n}});class n{constructor(t){this.database=t.instance}async get(t){return await this.database.categories.get(t)}async getAll(){return this.database.categories.toArray()}async put({categoryId:t,title:e,icon:a,articlesViewMode:n,tagPosition:r,tagSelectionMode:i}){try{const o=await this.database.categories.put({id:t,title:e,icon:a,articlesViewMode:n,tagPosition:r,tagSelectionMode:i});return console.log("Inserted. categoryId:",o),o}catch(o){console.error(o.stack||o)}}}},1736:function(t,e,a){a.d(e,{T:function(){return n.TU}});var n=a(1926);const r=new n.TU.Renderer,i=r.link;r.link=(t,e,a)=>{const n=t.startsWith(`${location.protocol}//${location.hostname}`),o=i.call(r,t,e,a);return n?o:o.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')},n.TU.setOptions({renderer:r})},4184:function(t,e,a){var n=a(690);const r={id:"app"};function i(t,e){const a=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(a)])}var o=a(673);const l={},s=(0,o.Z)(l,[["render",i]]);var c=s,u=a(8852),d=a(1791);const g={class:"d-flex flex-column h-100"},p={class:"flex-grow-1 h-0"},f={class:"h-100"};function v(t,e){return(0,n.wg)(),(0,n.iD)("div",g,[(0,n.WI)(t.$slots,"header",{},void 0,!0),(0,n._)("div",p,[(0,n._)("div",f,[(0,n.WI)(t.$slots,"default",{},void 0,!0)])]),(0,n.WI)(t.$slots,"footer",{},void 0,!0)])}const y={},m=(0,o.Z)(y,[["render",v],["__scopeId","data-v-184826a2"]]);var h=m;const w={class:"container-fluid h-100 container-main"},b={class:"row h-100"},k={key:0,class:"col-sm-4 col-md-3 col-12 h-100-sm sidebar pr-0"},_={class:"h-100 pr-3"};var S={__name:"TheMainLayout",props:{noSidebar:Boolean,mainPanelScroll:Boolean},setup(t){const e=t,a=(0,n.Fl)((()=>({"col-sm-8":!e.noSidebar,"col-sm-12":e.noSidebar,"col-md-9":!e.noSidebar,"col-md-12":e.noSidebar,"h-100-sm":!0,"panel-main":!0,"overflow-auto":e.mainPanelScroll})));return(e,r)=>((0,n.wg)(),(0,n.iD)("div",w,[(0,n._)("div",b,[t.noSidebar?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",k,[(0,n._)("div",_,[(0,n.WI)(e.$slots,"sidebar")])])),(0,n._)("div",{cols:"12",class:(0,n.C_)((0,n.SU)(a))},[(0,n.WI)(e.$slots,"panel-main")],2)])]))}};const x=S;var I=x,P=(a(825),a(7540));const A=t=>((0,n.dD)("data-v-0d365640"),t=t(),(0,n.Cn)(),t),T={class:"d-flex flex-column h-100"},D=A((()=>(0,n._)("h1",{class:"h2"},[(0,n._)("span",null,"🏠"),(0,n._)("span",{class:"site-title-animals"},"🐕🦘🐬🐓🕊🦢")],-1))),C=A((()=>(0,n._)("div",{class:"mt-auto"},null,-1))),M={key:0},E=["innerHTML"],F={key:1,class:"form-group"},U=A((()=>(0,n._)("i",{class:"far fa-newspaper"},null,-1))),j=A((()=>(0,n._)("span",{class:"ml-2"},"記事",-1))),Z=[U,j],O={key:2,class:"form-group"},R=A((()=>(0,n._)("i",{class:"far fa-folder-open"},null,-1))),q=A((()=>(0,n._)("span",{class:"ml-2"},"カテゴリー",-1))),B=[R,q],L={key:3,class:"form-group"},H=A((()=>(0,n._)("i",{class:"fas fa-cog"},null,-1))),N=A((()=>(0,n._)("span",{class:"ml-2"},"設定",-1))),V=[H,N];var W={__name:"TheSidebar",setup(t){(0,n.bv)((async()=>{null==P.DF.value&&await(0,P.Y1)()}));const e=()=>{u.Z.push({name:"ArticlesListPage"})},a=()=>{u.Z.push({name:"CategoryPage"})},r=()=>{u.Z.push({name:"SettingPage"})};return(t,i)=>((0,n.wg)(),(0,n.iD)("div",T,[D,(0,n.WI)(t.$slots,"default"),C,null!=(0,n.SU)(P.DF)?((0,n.wg)(),(0,n.iD)("div",M,[(0,n._)("div",{innerHTML:(0,n.SU)(P.DF).html},null,8,E)])):(0,n.kq)("",!0),"ArticlesListPage"!=t.$route.name?((0,n.wg)(),(0,n.iD)("fieldset",F,[(0,n._)("button",{class:"btn btn-link",onClick:e},Z)])):(0,n.kq)("",!0),"CategoryPage"!=t.$route.name?((0,n.wg)(),(0,n.iD)("fieldset",O,[(0,n._)("button",{class:"btn btn-link",onClick:a},B)])):(0,n.kq)("",!0),"SettingPage"!=t.$route.name?((0,n.wg)(),(0,n.iD)("fieldset",L,[(0,n._)("button",{class:"btn btn-link",onClick:r},V)])):(0,n.kq)("",!0)]))}};const $=(0,o.Z)(W,[["__scopeId","data-v-0d365640"]]);var z=$;n.ZP.component("NotFoundAlert",d.Z),n.ZP.component("FullHeight",h),n.ZP.component("TheMainLayout",I),n.ZP.component("TheSidebar",z),n.ZP.config.productionTip=!1,n.ZP.createApp({render:t=>t(c)}).use(u.Z).mount("#app")},8852:function(t,e,a){a.d(e,{Z:function(){return Dt}});var n=a(9977),r=a(690),i=a(3556),o=a(9128),l=(a(825),a(1736));const s={key:0,class:"fas fa-arrow-circle-down"},c={key:1,class:"fas fa-arrow-circle-up"};var u={__name:"ButtonExpand",props:{expanded:Boolean},emits:["click"],setup(t,{emit:e}){const a=t,n=()=>{e("click")};return(t,e)=>((0,r.wg)(),(0,r.iD)("button",{class:"btn btn-link p-0",onClick:n},[a.expanded?((0,r.wg)(),(0,r.iD)("i",s)):((0,r.wg)(),(0,r.iD)("i",c))]))}};const d=u;var g=d;const p={class:"card","body-class":"py-2"},f={class:"card-body py-2"},v={class:"d-flex align-items-center"},y={class:"mr-auto d-flex flex-column"},m={class:"title"},h={key:0},w=["href"],b={key:0,class:"tags"},k={key:0,class:"tags pr-2 h-interval"},_={class:"right-side"},S={key:0,class:"pr-2 d-inline-block h-interval"},x=(0,r._)("i",{class:"far fa-newspaper"},null,-1),I=[x],P=(0,r._)("i",{class:"fas fa-edit"},null,-1),A=[P],T=["innerHTML"];var D={__name:"ArticlePanel",props:{article:{type:Object,required:!0},tagPosition:{default:"right",type:String}},emits:["expand"],setup(t,{emit:e}){const a=t,i=((0,n.yj)(),(0,r.Fl)((()=>l.T.parse(a.article.text)))),o=(0,r.Fl)((()=>null!=a.article.text&&a.article.text.length>0)),s=(0,r.Fl)((()=>!0===a.article.expanded)),c=(0,r.Fl)((()=>"bottom"===a.tagPosition)),u=()=>{Dt.push({name:"ArticleEditPage",params:{id:a.article.id}})},d=()=>{Dt.push({name:"ArticleReadPage",params:{id:a.article.id}})},x=()=>{e("expand",!s.value)};return(e,a)=>((0,r.wg)(),(0,r.iD)("div",p,[(0,r._)("div",f,[(0,r._)("div",v,[(0,r._)("div",y,[(0,r._)("div",m,[null==t.article.url?((0,r.wg)(),(0,r.iD)("span",h,(0,r.zw)(t.article.title),1)):((0,r.wg)(),(0,r.iD)("a",{key:1,href:t.article.url,target:"_blank"},(0,r.zw)(t.article.title),9,w))]),(0,r.SU)(c)?((0,r.wg)(),(0,r.iD)("div",b,[null!=t.article.tags?((0,r.wg)(),(0,r.iD)("div",k,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.article.tags,(t=>((0,r.wg)(),(0,r.iD)("span",{key:t,class:"badge badge-info"},(0,r.zw)(t),1)))),128))])):(0,r.kq)("",!0)])):(0,r.kq)("",!0)]),(0,r._)("div",_,[(0,r.SU)(c)||null==t.article.tags?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",S,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.article.tags,(t=>((0,r.wg)(),(0,r.iD)("span",{key:t,class:"badge badge-info"},(0,r.zw)(t),1)))),128))])),(0,r.SU)(o)?((0,r.wg)(),(0,r.j4)(g,{key:1,expanded:(0,r.SU)(s),onClick:x},null,8,["expanded"])):(0,r.kq)("",!0),(0,r._)("button",{class:"btn btn-link",onClick:d},I),(0,r._)("button",{class:"btn btn-link",onClick:u},A)])]),(0,r.wy)((0,r._)("div",{innerHTML:(0,r.SU)(i),class:"article-body-view"},null,8,T),[[r.F8,(0,r.SU)(s)]])])]))}};const C=D;var M=C;const E=(0,r._)("i",{class:"fas fa-plus"},null,-1),F=[E];var U={__name:"ButtonArticleCreatePage",props:{categoryId:Number},setup(t){const e=t,a=()=>{const{categoryId:t}=e;Dt.push({name:"ArticleCreatePage",params:{categoryId:t}})};return(t,e)=>((0,r.wg)(),(0,r.iD)("button",{class:"btn btn-link",onClick:a},F))}};const j=U;var Z=j;const O=(0,r._)("i",{class:"fas fa-cog"},null,-1),R=[O];var q={__name:"ButtonCategorySettingPage",props:{categoryId:Number},setup(t){const e=t,a=()=>{const{categoryId:t}=e;Dt.push({name:"CategorySettingPage",params:{categoryId:t}})};return(t,e)=>((0,r.wg)(),(0,r.iD)("button",{class:"btn btn-link",onClick:a},R))}};const B=q;var L=B;const H=["href"];var N={__name:"CampactLinksPanel",props:{table:Array},setup(t){const e=t;return(t,a)=>((0,r.wg)(),(0,r.iD)("div",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.table,(t=>((0,r.wg)(),(0,r.iD)("div",{key:t.text,class:"h-interval"},[(0,r._)("h3",null,(0,r.zw)(t.text),1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.articles,(t=>((0,r.wg)(),(0,r.iD)("a",{key:t.id,href:t.url,target:"_blank"},(0,r.zw)(t.title),9,H)))),128))])))),128))]))}};const V=N;var W=V;const $={class:"nav nav-pills small"},z={class:"nav-item"},Y={class:"nav-item"};var K={__name:"NavArticleViewMode",props:{mode:String},emits:["change"],setup(t,{emit:e}){const a=t,n=(0,r.Fl)((()=>({active:"compact"===a.mode,"nav-link":!0}))),i=(0,r.Fl)((()=>({active:"detail"===a.mode,"nav-link":!0}))),o=()=>{e("change","compact")},l=()=>{e("change","detail")};return(t,e)=>((0,r.wg)(),(0,r.iD)("ul",$,[(0,r._)("li",z,[(0,r._)("a",{class:(0,r.C_)((0,r.SU)(n)),href:"#",target:"_self",onClick:o}," コンパクト ",2)]),(0,r._)("li",Y,[(0,r._)("a",{class:(0,r.C_)((0,r.SU)(i)),href:"#",target:"_self",onClick:l}," 詳細 ",2)])]))}};const X=K;var Q=X;class G{create(t,e){const a=this.getArticles(t,e),n=this.getTags(a);return this.getTable(a,n)}getArticles(t,e){return t.filter((t=>null!=t.url)).filter((t=>this.isTargetArticle(t,e)))}isTargetArticle(t,e){return null==e||e.length<=0||null!=t.tags&&e.every((e=>t.tags.includes(e)))}getTags(t){const e=t.some((t=>null==t.tags||t.tags.length<=0)),a=e?[{text:"（タグなし）",value:null}]:[],n=t.map((t=>t.tags)).reduce(((t,e)=>(e.forEach((e=>{!1===t.includes(e)&&t.push(e)})),t)),[]).map((t=>({text:t,value:t})));return[...a,...n]}getTable(t,e){return e.map((e=>{const a=t.filter((t=>null==e.value?null==t.tags||t.tags.length<=0:null!=t.tags&&t.tags.includes(e.value)));return{...e,articles:a}}))}}const J={class:"h-100"},tt={class:"d-flex"},et={class:"ml-auto"},at={class:"form-group"},nt={class:"command-bar d-flex justify-content-end"},rt={class:"alerts pt-3"},it={key:0,class:"alert alert-warning"},ot={key:1,class:"alert alert-warning"},lt={key:2,class:"alert alert-warning"},st={key:0,class:"pt-3"};var ct={__name:"ArticleListPageMainPanel",props:{category:{type:Object,required:!0}},setup(t){const e=t,a=new G,n=(0,r.Fl)((()=>"detail"===e.category.articlesViewMode?"detail":"compact")),l=(0,r.Fl)((()=>"compact"===n.value)),s=(0,r.Fl)((()=>"detail"===n.value)),c=(0,r.Fl)((()=>o.BX.value.filter((t=>a.isTargetArticle(t,o.o1.value))))),u=(0,r.Fl)((()=>{const t=o.BX.value;return a.create(t,o.o1.value)})),d=(0,r.Fl)((()=>s.value&&c.value.length<=0&&u.value.length>0)),g=(0,r.Fl)((()=>l.value&&c.value.length>0&&u.value.length<=0)),p=(0,r.Fl)((()=>c.value.length<=0&&u.value.length<=0)),f=(t,e)=>{const{id:a}=t;(0,i.z0)({id:a,expanded:e})},v=t=>{const a=e.category.id;(0,i.jB)({categoryId:a,articlesViewMode:t})};return(e,a)=>((0,r.wg)(),(0,r.iD)("div",J,[(0,r._)("div",tt,[(0,r._)("h2",null,(0,r.zw)(t.category.title),1),(0,r._)("div",et,[(0,r._)("fieldset",at,[(0,r.Wm)(L,{"category-id":t.category.id},null,8,["category-id"]),(0,r.Wm)(Z,{"category-id":t.category.id},null,8,["category-id"])])])]),(0,r._)("div",nt,[(0,r.Wm)(Q,{mode:(0,r.SU)(n),onChange:v},null,8,["mode"])]),(0,r._)("div",rt,[(0,r.SU)(d)?((0,r.wg)(),(0,r.iD)("div",it," 詳細モードで可能な記事がありません。コンパクトモードであれば表示できます。 ")):(0,r.kq)("",!0),(0,r.SU)(g)?((0,r.wg)(),(0,r.iD)("div",ot," コンパクトモードで可能な記事がありません。詳細モードであれば表示できます。 ")):(0,r.kq)("",!0),(0,r.SU)(p)?((0,r.wg)(),(0,r.iD)("div",lt," 検索条件に合致する記事がありません。 ")):(0,r.kq)("",!0)]),(0,r.SU)(s)?((0,r.wg)(),(0,r.iD)("div",st,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(c),(e=>((0,r.wg)(),(0,r.j4)(M,{key:e.id,article:e,tagPosition:t.category.tagPosition,onExpand:t=>f(e,t)},null,8,["article","tagPosition","onExpand"])))),128))])):(0,r.kq)("",!0),(0,r.SU)(l)?((0,r.wg)(),(0,r.j4)(W,{key:1,table:(0,r.SU)(u),class:"pt-3"},null,8,["table"])):(0,r.kq)("",!0)]))}};const ut=ct;var dt=ut;const gt={class:"nav flex-column nav-category mt-3"},pt=["onClick"];var ft={__name:"NavCategories",setup(t){const e=(0,r.Fl)((()=>o.ns.value.map((t=>{const{id:e,title:a}=t,n=e===o.PE.value,r={active:n,"nav-link":!0};return{anchorClass:r,id:e,title:a}})))),a=async t=>{null!=t&&((0,o.uA)(t.id),await(0,i.nw)(t.id))};return(t,n)=>((0,r.wg)(),(0,r.iD)("ul",gt,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(e),(t=>((0,r.wg)(),(0,r.iD)("li",{class:"nav-item",key:t.id,onClick:e=>a(t)},[(0,r._)("a",{class:(0,r.C_)(t.anchorClass),href:"#",target:"_self"},(0,r.zw)(t.title),3)],8,pt)))),128))]))}};const vt=ft;var yt=vt,mt=a(7540);const ht={class:"form-group"},wt=["onClick"];var bt={__name:"FormGroupTagButtons",setup(t){const e=(0,r.Fl)((()=>mt.c3.value.map((t=>{const{selected:e,text:a}=t,n=e?"btn btn-sm btn-info":"btn btn-sm btn-outline-info";return{selected:e,text:a,className:n}})))),a=t=>{const{text:e,selected:a}=t;(0,o.aV)({text:e,selected:!a})};return(t,n)=>((0,r.wg)(),(0,r.iD)("fieldset",ht,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(e),(t=>((0,r.wg)(),(0,r.iD)("button",{key:t.text,class:(0,r.C_)(t.className),onClick:e=>a(t)},(0,r.zw)(t.text),11,wt)))),128))]))}};const kt=bt;var _t=kt;const St={class:"h-100"};var xt={__name:"ArticlesListPage",setup(t){const e=(0,r.Fl)((()=>o.ns.value.filter((t=>t.id===o.PE.value))[0]));return(0,r.bv)((()=>{(0,i.Uy)()})),(t,a)=>{const n=(0,r.up)("TheSidebar"),i=(0,r.up)("TheMainLayout");return(0,r.wg)(),(0,r.j4)(i,{"main-panel-scroll":""},{sidebar:(0,r.w5)((()=>[(0,r.Wm)(n,null,{default:(0,r.w5)((()=>[(0,r.Wm)(yt,{class:"mt-3"}),(0,r.Wm)(_t,{class:"mt-3"})]),void 0,!0),_:1})])),"panel-main":(0,r.w5)((()=>[(0,r._)("div",St,[null!=(0,r.SU)(e)?((0,r.wg)(),(0,r.j4)(dt,{key:0,category:(0,r.SU)(e)},null,8,["category"])):(0,r.kq)("",!0)])])),_:1})}}};const It=xt;var Pt=It;const At=[{path:"/",name:"ArticlesListPage",component:Pt},{path:"/categories/:categoryId/articles/create",name:"ArticleCreatePage",component:()=>a.e(525).then(a.bind(a,3822))},{path:"/articles/:id/edit",name:"ArticleEditPage",component:()=>a.e(525).then(a.bind(a,1267))},{path:"/articles/:id/read",name:"ArticleReadPage",component:()=>a.e(525).then(a.bind(a,2425))},{path:"/categories",name:"CategoryPage",component:()=>a.e(267).then(a.bind(a,1691))},{path:"/categories/:id/import",name:"CategoryImportPage",component:()=>a.e(267).then(a.bind(a,9730))},{path:"/categories/:categoryId/setting",name:"CategorySettingPage",component:()=>a.e(267).then(a.bind(a,39))},{path:"/settings",name:"SettingPage",component:()=>a.e(571).then(a.bind(a,2879))}],Tt=(0,n.p7)({history:(0,n.r5)(),routes:At});var Dt=Tt},3556:function(t,e,a){a.d(e,{jA:function(){return y},_b:function(){return m},nw:function(){return S},Uy:function(){return x},z0:function(){return I},jB:function(){return P},ag:function(){return A},Q2:function(){return w}});class n{fromArticles(t){return t.map((t=>{const e=null==t.text?null:t.text.match("^https?://[^ \r\n\t]+"),a=null==e?null:e[0];return{expanded:!1,url:a,...t}}))}}var r=a(2974),i=a(4334),o=a(9401),l=a(9568);class s{constructor(t){this.categoryRepository=t}async setSettings(t,{articlesViewMode:e,tagPosition:a,tagSelectionMode:n}){const r=await this.categoryRepository.get(t);if(null==r)throw console.error("Specified categoryId not found. categoryId:",t),new Error("Specified categoryId not found. categoryId: "+t);const i={...r,categoryId:t,articlesViewMode:e??r.articlesViewMode,tagPosition:a??r.tagPosition,tagSelectionMode:n??r.tagSelectionMode};try{await this.categoryRepository.put(i),console.log("保存しました(service):",i)}catch(o){console.error("カテゴリーを保存できませんでした。",o.stack||o)}}}class c{constructor(t){this.database=t.instance}async get(t){return await this.database.settings.get(t)}async put(t){try{return await this.database.settings.put(t)}catch(e){console.error(e.stack??e)}}}class u{constructor(t){this.settingRepository=t}async getSidebarSetting(){const{articleId:t}=await this.settingRepository.get("sidebar")??{};return{name:"sidebar",articleId:t}}async setSidebarArticleId(t){const e=await this.getSidebarSetting();e.articleId=t,console.log("service sidebar:",e),await this.settingRepository.put(e)}}var d=a(9128);const g=new n,p=new i.Z,f=new l.Z(p),v=new s(f),y=new r.Z(p),m=new o.Z(y,f),h=new c(p),w=new u(h),b=({id:t,expanded:e})=>{d.BX.value.filter((e=>e.id===t)).forEach((t=>{t.expanded=e}))},k=t=>{d.ns.value=t,t.length>0&&null==d.PE.value&&(d.PE.value=t[0].id)},_=({categoryId:t,articlesViewMode:e,tagPosition:a,tagSelectionMode:n})=>{d.ns.value.filter((e=>e.id===t)).forEach((t=>{t.articlesViewMode=e??t.articlesViewMode,t.tagPosition=a??t.tagPosition,t.tagSelectionMode=n??t.tagSelectionMode}))},S=async t=>{const e=await m.get({categoryId:t});d.BX.value=g.fromArticles(e),(0,d.uA)(t)},x=async()=>{const t=await f.getAll();k(t),null!=d.PE.value&&await S(d.PE.value)},I=({id:t,expanded:e})=>{b({id:t,expanded:e}),m.setExpanding(t,e)},P=async({categoryId:t,articlesViewMode:e})=>{_({categoryId:t,articlesViewMode:e}),await v.setSettings(t,{articlesViewMode:e})},A=async({categoryId:t,tagPosition:e,tagSelectionMode:a})=>{_({categoryId:t,tagPosition:e,tagSelectionMode:a}),await v.setSettings(t,{tagPosition:e,tagSelectionMode:a})}},7540:function(t,e,a){a.d(e,{$1:function(){return s},DF:function(){return c},Pn:function(){return d},Y1:function(){return u},c3:function(){return l}});a(825);var n=a(690),r=a(9128),i=a(3556),o=a(1736);const l=(0,n.Fl)((()=>{const t=r.BX.value.map((t=>t.tags??[])).reduce(((t,e)=>(e.filter((e=>!1===t.includes(e))).forEach((e=>t.push(e))),t)),[]);return t.map((t=>{const e=r.o1.value.includes(t);return{selected:e,text:t,value:t}}))})),s=async t=>{const e=await i._b.get({categoryId:t});i.jA["export"](e)},c=(0,n.iH)(null),u=async()=>{const{articleId:t}=await i.Q2.getSidebarSetting();if(null==t)return void(c.value=null);const e=await i._b.get({articleId:t}),a=e[0],n=null==a?.text?null:o.T.parse(a.text);c.value={html:n,...a}},d=async t=>{await i.Q2.setSidebarArticleId(t),await u()}},9128:function(t,e,a){a.d(e,{BX:function(){return r},PE:function(){return i},aV:function(){return c},ns:function(){return l},o1:function(){return o},uA:function(){return s}});a(825);var n=a(690);const r=(0,n.iH)([]),i=(0,n.iH)(null),o=(0,n.iH)([]),l=(0,n.iH)([]),s=t=>{i.value=t,o.value=[]},c=({text:t,selected:e})=>{const a=l.value.filter((t=>t.id===i.value)),n=a[0]?.tagSelectionMode??"single",r=o.value.includes(t);"single"!==n?r?!1===e&&(o.value=o.value.filter((e=>e!==t)),console.log("1")):e&&o.value.push(t):o.value=r?[]:[t]}},9401:function(t,e,a){a.d(e,{Z:function(){return n}});class n{constructor(t,e){this.articleRepository=t,this.categoryRepository=e}async get({categoryId:t,articleId:e}){try{const a=await this.articleRepository.getArticles({categoryId:t,articleId:e}),n=a.map((t=>t.id)),r=await this.articleRepository.getArticleTags(n);return a.map((t=>this.getResult(t,r)))}catch(a){console.error("記事読み込めませんでした。",a)}}async set({id:t,categoryId:e,expanded:a,title:n,text:r,tags:i}){const o=await this.categoryRepository.get(e);if(null==o)throw console.error("Specified categoryId not found. categoryId:",e),new Error("Specified categoryId not found. categoryId: "+e);try{const o=await this.articleRepository.setArticle({id:t,categoryId:e,expanded:a,title:n,text:r});console.log("Inserted. articleId:",o);const l=await this.articleRepository.getArticleTags([o]);if(!this.areEqualTagsToArticleTags(i,l)){const t=l.map((t=>t.id));await this.articleRepository.deleteTagsFromArticle(t),await this.articleRepository.addTagsToArticle(o,i)}return o}catch(l){console.error("記事を保存できませんでした。",l.stack||l)}}async setExpanding(t,e){try{const a=await this.articleRepository.getArticles({articleId:t});if(a.length<=0)throw new Error("Specified articleId not found. articleId: "+t);a[0].expanded=e,this.articleRepository.setArticle(a[0])}catch(a){console.error("記事を保存できませんでした。",a.stack||a)}}getResult(t,e){const a=e.filter((e=>e.articleId===t.id)).map((t=>t.tagText)),n=Array.from(new Set(a).values());return{...t,tags:n}}areEqualTagsToArticleTags(t,e){if(t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==e[a].tagText)return!1;return!0}}},1791:function(t,e,a){a.d(e,{Z:function(){return c}});var n=a(690);const r={class:"alert alert-warning"};function i(t,e){return(0,n.wg)(),(0,n.iD)("div",r," データがありません。 ")}var o=a(673);const l={},s=(0,o.Z)(l,[["render",i]]);var c=s}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,a),i.exports}a.m=t,function(){var t=[];a.O=function(e,n,r,i){if(!n){var o=1/0;for(u=0;u<t.length;u++){n=t[u][0],r=t[u][1],i=t[u][2];for(var l=!0,s=0;s<n.length;s++)(!1&i||o>=i)&&Object.keys(a.O).every((function(t){return a.O[t](n[s])}))?n.splice(s--,1):(l=!1,i<o&&(o=i));if(l){t.splice(u--,1);var c=r();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[n,r,i]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(e,n){return a.f[n](t,e),e}),[]))}}(),function(){a.u=function(t){return"js/"+{267:"categories",525:"articles",571:"settings"}[t]+"."+{267:"58a104e7",525:"c18e0c97",571:"2fc53132"}[t]+".js"}}(),function(){a.miniCssF=function(t){return"css/articles.7fa173b7.css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="portal:";a.l=function(n,r,i,o){if(t[n])t[n].push(r);else{var l,s;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==e+i){l=d;break}}l||(s=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.setAttribute("data-webpack",e+i),l.src=n),t[n]=[r];var g=function(e,a){l.onerror=l.onload=null,clearTimeout(p);var r=t[n];if(delete t[n],l.parentNode&&l.parentNode.removeChild(l),r&&r.forEach((function(t){return t(a)})),e)return e(a)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=g.bind(null,l.onerror),l.onload=g.bind(null,l.onload),s&&document.head.appendChild(l)}}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.p=""}(),function(){if("undefined"!==typeof document){var t=function(t,e,a,n,r){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var o=function(a){if(i.onerror=i.onload=null,"load"===a.type)n();else{var o=a&&("load"===a.type?"missing":a.type),l=a&&a.target&&a.target.href||e,s=new Error("Loading CSS chunk "+t+" failed.\n("+l+")");s.code="CSS_CHUNK_LOAD_FAILED",s.type=o,s.request=l,i.parentNode.removeChild(i),r(s)}};return i.onerror=i.onload=o,i.href=e,a?a.parentNode.insertBefore(i,a.nextSibling):document.head.appendChild(i),i},e=function(t,e){for(var a=document.getElementsByTagName("link"),n=0;n<a.length;n++){var r=a[n],i=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(i===t||i===e))return r}var o=document.getElementsByTagName("style");for(n=0;n<o.length;n++){r=o[n],i=r.getAttribute("data-href");if(i===t||i===e)return r}},n=function(n){return new Promise((function(r,i){var o=a.miniCssF(n),l=a.p+o;if(e(o,l))return r();t(n,l,null,r,i)}))},r={143:0};a.f.miniCss=function(t,e){var a={525:1};r[t]?e.push(r[t]):0!==r[t]&&a[t]&&e.push(r[t]=n(t).then((function(){r[t]=0}),(function(e){throw delete r[t],e})))}}}(),function(){var t={143:0};a.f.j=function(e,n){var r=a.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise((function(a,n){r=t[e]=[a,n]}));n.push(r[2]=i);var o=a.p+a.u(e),l=new Error,s=function(n){if(a.o(t,e)&&(r=t[e],0!==r&&(t[e]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;l.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",l.name="ChunkLoadError",l.type=i,l.request=o,r[1](l)}};a.l(o,s,"chunk-"+e,e)}},a.O.j=function(e){return 0===t[e]};var e=function(e,n){var r,i,o=n[0],l=n[1],s=n[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(s)var u=s(a)}for(e&&e(n);c<o.length;c++)i=o[c],a.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return a.O(u)},n=self["webpackChunkportal"]=self["webpackChunkportal"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(4184)}));n=a.O(n)})();
//# sourceMappingURL=app.9a387bae.js.map